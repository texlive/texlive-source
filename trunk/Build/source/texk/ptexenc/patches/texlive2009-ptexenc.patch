Index: m4/kpse-ptexenc-flags.m4
===================================================================
--- texlive-20091011-source.orig/m4/kpse-ptexenc-flags.m4
+++ texlive-20091011-source/m4/kpse-ptexenc-flags.m4
@@ -0,0 +1,30 @@
+# Public macros for the TeX Live (TL) tree.
+# Copyright (C) 2009 Peter Breitenlohner <tex-live@tug.org>
+#
+# This file is free software; the copyright holder
+# gives unlimited permission to copy and/or distribute it,
+# with or without modifications, as long as this notice is preserved.
+
+# serial 0
+
+# KPSE_PTEXENC_FLAGS
+# -------------------
+# Provide the configure options '--with-system-ptexenc' (if in the TL tree),
+# '--with-ptexenc-includes', and '--with-ptexenc-libdir'.
+#
+# Set the make variables PTEXENC_INCLUDES and PTEXENC_LIBS to the CPPFLAGS and
+# LIBS required for the `-lptexenc' library in texk/ptexenc/ of the TL tree.
+AC_DEFUN([KPSE_PTEXENC_FLAGS],
+[_KPSE_LIB_FLAGS([ptexenc], [ptexenc], [tree],
+                 [-IBLD/texk -ISRC/texk], [BLD/texk/ptexenc/libptexenc.la], [],
+                 [${top_srcdir}/../ptexenc/*.[ch]],
+                 [${top_builddir}/../ptexenc/ptexenc.h])[]dnl
+]) # KPSE_PTEXENC_FLAGS
+
+# KPSE_PTEXENC_OPTIONS([WITH-SYSTEM])
+# ------------------------------------
+AC_DEFUN([KPSE_PTEXENC_OPTIONS], [_KPSE_LIB_OPTIONS([ptexenc], [$1])])
+
+# KPSE_PTEXENC_SYSTEM_FLAGS
+# --------------------------
+AC_DEFUN([KPSE_PTEXENC_SYSTEM_FLAGS], [_KPSE_LIB_FLAGS_SYSTEM([ptexenc], [ptexenc])])
Index: m4/kpse-pkgs.m4
===================================================================
--- texlive-20091011-source.orig/m4/kpse-pkgs.m4
+++ texlive-20091011-source/m4/kpse-pkgs.m4
@@ -72,6 +72,7 @@
 # excluding 'texk/kpathsea'.
 AC_DEFUN([KPSE_TEXK_PKGS],
 [m4_define([kpse_texk_pkgs], [
+ptexenc
 web2c
 afm2pl
 bibtex8
@@ -90,8 +91,12 @@
 lacheck
 lcdf-typetools
 makeindexk
+makejvf
+mendexk
 musixflx
+pdvipsk
 ps2pkm
+pxdvik
 seetexk
 tex4htk
 ttf2pk
Index: configure
===================================================================
--- texlive-20091011-source.orig/configure
+++ texlive-20091011-source/configure
@@ -945,6 +945,7 @@
 enable_omfonts
 enable_tex
 enable_etex
+enable_ptex
 enable_aleph
 enable_pdftex
 enable_luatex
@@ -994,6 +995,8 @@
 enable_ttftotype42
 enable_updmap
 enable_makeindexk
+enable_makejvf
+enable_mendexk
 enable_musixflx
 enable_ps2pkm
 enable_seetexk
@@ -1729,6 +1732,7 @@
                             versions)
   --disable-tex             do not compile and install TeX
   --enable-etex             compile and install e-TeX
+  --disable-ptex            do not compile and install pTeX
   --disable-aleph           do not compile and install Aleph
   --disable-pdftex          do not compile and install pdfTeX
   --disable-luatex          do not compile and install luaTeX
@@ -1780,6 +1784,8 @@
   --disable-auto-t1dotlessj disable running t1dotlessj from otftotfm
   --disable-auto-updmap     disable running updmap from otftotfm
   --disable-makeindexk    do not build the makeindexk package
+  --disable-makejvf       do not build the makejvf package
+  --disable-mendexk       do not build the mendexk package
   --disable-musixflx      do not build the musixflx package
   --disable-ps2pkm        do not build the ps2pkm package
   --disable-seetexk       do not build the seetexk package
@@ -2691,6 +2697,10 @@
 
 
 
+## texk/ptexenc/ac/withenable.ac: configure.ac fragment for the TeX Live subdirectory texk/ptexenc/
+## configure options and TL libraries required for ptexenc
+
+
 ## texk/web2c/ac/withenable.ac: configure.ac fragment for the TeX Live subdirectory texk/web2c/
 ## configure options and TL libraries required for web2c
 # Check whether --enable-web2c was given.
@@ -2755,6 +2765,18 @@
   yes|no) : ;;
   *) enable_etex=no ;;
 esac
+# Check whether --enable-ptex was given.
+if test "${enable_ptex+set}" = set; then
+  enableval=$enable_ptex;
+fi
+case $enable_ptex in
+  yes|no) : ;;
+  *) enable_ptex=yes ;;
+esac
+
+test "x$enable_web2c:$enable_ptex" = xyes:yes && {
+  need_ptexenc=yes
+}
 # Check whether --enable-aleph was given.
 if test "${enable_aleph+set}" = set; then
   enableval=$enable_aleph;
@@ -3269,6 +3291,46 @@
 }
 
 
+## texk/makejvf/ac/withenable.ac: configure.ac fragment for the TeX Live subdirectory texk/makejvf/
+## configure options and TL libraries required for makeindexk
+# Check whether --enable-makejvf was given.
+if test "${enable_makejvf+set}" = set; then
+  enableval=$enable_makejvf;
+fi
+case $enable_makejvf in #(
+  yes|no);; #(
+  *) enable_makejvf=$enable_all_pkgs
+     { $as_echo "$as_me:$LINENO: Assuming \`--enable-makejvf=$enable_makejvf'" >&5
+$as_echo "$as_me: Assuming \`--enable-makejvf=$enable_makejvf'" >&6;}
+     ac_configure_args="$ac_configure_args '--enable-makejvf=$enable_makejvf'";;
+esac
+
+test "x$enable_makejvf" = xno || {
+  need_kpathsea=yes
+  need_ptexenc=yes
+}
+
+
+## texk/mendexk/ac/withenable.ac: configure.ac fragment for the TeX Live subdirectory texk/mendexk/
+## configure options and TL libraries required for makeindexk
+# Check whether --enable-mendexk was given.
+if test "${enable_mendexk+set}" = set; then
+  enableval=$enable_mendexk;
+fi
+case $enable_mendexk in #(
+  yes|no);; #(
+  *) enable_mendexk=$enable_all_pkgs
+     { $as_echo "$as_me:$LINENO: Assuming \`--enable-mendexk=$enable_mendexk'" >&5
+$as_echo "$as_me: Assuming \`--enable-mendexk=$enable_mendexk'" >&6;}
+     ac_configure_args="$ac_configure_args '--enable-mendexk=$enable_mendexk'";;
+esac
+
+test "x$enable_mendexk" = xno || {
+  need_kpathsea=yes
+  need_ptexenc=yes
+}
+
+
 ## texk/musixflx/ac/withenable.ac: configure.ac fragment for the TeX Live subdirectory texk/musixflx/
 ## configure options and TL libraries required for musixflx
 # Check whether --enable-musixflx was given.
@@ -3284,6 +3346,7 @@
 esac
 
 
+
 ## texk/ps2pkm/ac/withenable.ac: configure.ac fragment for the TeX Live subdirectory texk/ps2pkm/
 ## configure options and TL libraries required for ps2pkm
 # Check whether --enable-ps2pkm was given.
@@ -3303,6 +3366,7 @@
 }
 
 
+
 ## texk/seetexk/ac/withenable.ac: configure.ac fragment for the TeX Live subdirectory texk/seetexk/
 ## configure options and TL libraries required for seetexk
 # Check whether --enable-seetexk was given.
@@ -6203,13 +6267,13 @@
 else
   lt_cv_nm_interface="BSD nm"
   echo "int some_variable = 0;" > conftest.$ac_ext
-  (eval echo "\"\$as_me:6206: $ac_compile\"" >&5)
+  (eval echo "\"\$as_me:6270: $ac_compile\"" >&5)
   (eval "$ac_compile" 2>conftest.err)
   cat conftest.err >&5
-  (eval echo "\"\$as_me:6209: $NM \\\"conftest.$ac_objext\\\"\"" >&5)
+  (eval echo "\"\$as_me:6273: $NM \\\"conftest.$ac_objext\\\"\"" >&5)
   (eval "$NM \"conftest.$ac_objext\"" 2>conftest.err > conftest.out)
   cat conftest.err >&5
-  (eval echo "\"\$as_me:6212: output\"" >&5)
+  (eval echo "\"\$as_me:6276: output\"" >&5)
   cat conftest.out >&5
   if $GREP 'External.*some_variable' conftest.out > /dev/null; then
     lt_cv_nm_interface="MS dumpbin"
@@ -7415,7 +7479,7 @@
   ;;
 *-*-irix6*)
   # Find out which ABI we are using.
-  echo '#line 7418 "configure"' > conftest.$ac_ext
+  echo '#line 7482 "configure"' > conftest.$ac_ext
   if { (eval echo "$as_me:$LINENO: \"$ac_compile\"") >&5
   (eval $ac_compile) 2>&5
   ac_status=$?
@@ -9376,11 +9440,11 @@
    -e 's:.*FLAGS}\{0,1\} :&$lt_compiler_flag :; t' \
    -e 's: [^ ]*conftest\.: $lt_compiler_flag&:; t' \
    -e 's:$: $lt_compiler_flag:'`
-   (eval echo "\"\$as_me:9379: $lt_compile\"" >&5)
+   (eval echo "\"\$as_me:9443: $lt_compile\"" >&5)
    (eval "$lt_compile" 2>conftest.err)
    ac_status=$?
    cat conftest.err >&5
-   echo "$as_me:9383: \$? = $ac_status" >&5
+   echo "$as_me:9447: \$? = $ac_status" >&5
    if (exit $ac_status) && test -s "$ac_outfile"; then
      # The compiler can only warn and ignore the option if not recognized
      # So say no if there are warnings other than the usual output.
@@ -9715,11 +9779,11 @@
    -e 's:.*FLAGS}\{0,1\} :&$lt_compiler_flag :; t' \
    -e 's: [^ ]*conftest\.: $lt_compiler_flag&:; t' \
    -e 's:$: $lt_compiler_flag:'`
-   (eval echo "\"\$as_me:9718: $lt_compile\"" >&5)
+   (eval echo "\"\$as_me:9782: $lt_compile\"" >&5)
    (eval "$lt_compile" 2>conftest.err)
    ac_status=$?
    cat conftest.err >&5
-   echo "$as_me:9722: \$? = $ac_status" >&5
+   echo "$as_me:9786: \$? = $ac_status" >&5
    if (exit $ac_status) && test -s "$ac_outfile"; then
      # The compiler can only warn and ignore the option if not recognized
      # So say no if there are warnings other than the usual output.
@@ -9820,11 +9884,11 @@
    -e 's:.*FLAGS}\{0,1\} :&$lt_compiler_flag :; t' \
    -e 's: [^ ]*conftest\.: $lt_compiler_flag&:; t' \
    -e 's:$: $lt_compiler_flag:'`
-   (eval echo "\"\$as_me:9823: $lt_compile\"" >&5)
+   (eval echo "\"\$as_me:9887: $lt_compile\"" >&5)
    (eval "$lt_compile" 2>out/conftest.err)
    ac_status=$?
    cat out/conftest.err >&5
-   echo "$as_me:9827: \$? = $ac_status" >&5
+   echo "$as_me:9891: \$? = $ac_status" >&5
    if (exit $ac_status) && test -s out/conftest2.$ac_objext
    then
      # The compiler can only warn and ignore the option if not recognized
@@ -9875,11 +9939,11 @@
    -e 's:.*FLAGS}\{0,1\} :&$lt_compiler_flag :; t' \
    -e 's: [^ ]*conftest\.: $lt_compiler_flag&:; t' \
    -e 's:$: $lt_compiler_flag:'`
-   (eval echo "\"\$as_me:9878: $lt_compile\"" >&5)
+   (eval echo "\"\$as_me:9942: $lt_compile\"" >&5)
    (eval "$lt_compile" 2>out/conftest.err)
    ac_status=$?
    cat out/conftest.err >&5
-   echo "$as_me:9882: \$? = $ac_status" >&5
+   echo "$as_me:9946: \$? = $ac_status" >&5
    if (exit $ac_status) && test -s out/conftest2.$ac_objext
    then
      # The compiler can only warn and ignore the option if not recognized
@@ -12675,7 +12739,7 @@
   lt_dlunknown=0; lt_dlno_uscore=1; lt_dlneed_uscore=2
   lt_status=$lt_dlunknown
   cat > conftest.$ac_ext <<_LT_EOF
-#line 12678 "configure"
+#line 12742 "configure"
 #include "confdefs.h"
 
 #if HAVE_DLFCN_H
@@ -12771,7 +12835,7 @@
   lt_dlunknown=0; lt_dlno_uscore=1; lt_dlneed_uscore=2
   lt_status=$lt_dlunknown
   cat > conftest.$ac_ext <<_LT_EOF
-#line 12774 "configure"
+#line 12838 "configure"
 #include "confdefs.h"
 
 #if HAVE_DLFCN_H
@@ -19271,11 +19335,11 @@
    -e 's:.*FLAGS}\{0,1\} :&$lt_compiler_flag :; t' \
    -e 's: [^ ]*conftest\.: $lt_compiler_flag&:; t' \
    -e 's:$: $lt_compiler_flag:'`
-   (eval echo "\"\$as_me:19274: $lt_compile\"" >&5)
+   (eval echo "\"\$as_me:19338: $lt_compile\"" >&5)
    (eval "$lt_compile" 2>conftest.err)
    ac_status=$?
    cat conftest.err >&5
-   echo "$as_me:19278: \$? = $ac_status" >&5
+   echo "$as_me:19342: \$? = $ac_status" >&5
    if (exit $ac_status) && test -s "$ac_outfile"; then
      # The compiler can only warn and ignore the option if not recognized
      # So say no if there are warnings other than the usual output.
@@ -19370,11 +19434,11 @@
    -e 's:.*FLAGS}\{0,1\} :&$lt_compiler_flag :; t' \
    -e 's: [^ ]*conftest\.: $lt_compiler_flag&:; t' \
    -e 's:$: $lt_compiler_flag:'`
-   (eval echo "\"\$as_me:19373: $lt_compile\"" >&5)
+   (eval echo "\"\$as_me:19437: $lt_compile\"" >&5)
    (eval "$lt_compile" 2>out/conftest.err)
    ac_status=$?
    cat out/conftest.err >&5
-   echo "$as_me:19377: \$? = $ac_status" >&5
+   echo "$as_me:19441: \$? = $ac_status" >&5
    if (exit $ac_status) && test -s out/conftest2.$ac_objext
    then
      # The compiler can only warn and ignore the option if not recognized
@@ -19422,11 +19486,11 @@
    -e 's:.*FLAGS}\{0,1\} :&$lt_compiler_flag :; t' \
    -e 's: [^ ]*conftest\.: $lt_compiler_flag&:; t' \
    -e 's:$: $lt_compiler_flag:'`
-   (eval echo "\"\$as_me:19425: $lt_compile\"" >&5)
+   (eval echo "\"\$as_me:19489: $lt_compile\"" >&5)
    (eval "$lt_compile" 2>out/conftest.err)
    ac_status=$?
    cat out/conftest.err >&5
-   echo "$as_me:19429: \$? = $ac_status" >&5
+   echo "$as_me:19493: \$? = $ac_status" >&5
    if (exit $ac_status) && test -s out/conftest2.$ac_objext
    then
      # The compiler can only warn and ignore the option if not recognized
Index: Makefile.in
===================================================================
--- texlive-20091011-source.orig/Makefile.in
+++ texlive-20091011-source/Makefile.in
@@ -68,6 +68,7 @@
 	$(top_srcdir)/utils/vlna/ac/withenable.ac \
 	$(top_srcdir)/utils/xindy/ac/withenable.ac \
 	$(top_srcdir)/utils/xindy/ac/xindy.ac \
+	$(top_srcdir)/texk/ptexenc/ac/withenable.ac \
 	$(top_srcdir)/texk/web2c/ac/withenable.ac \
 	$(top_srcdir)/texk/web2c/ac/web2c.ac \
 	$(top_srcdir)/texk/afm2pl/ac/withenable.ac \
@@ -89,6 +90,8 @@
 	$(top_srcdir)/texk/lcdf-typetools/ac/withenable.ac \
 	$(top_srcdir)/texk/lcdf-typetools/ac/lcdf-typetools.ac \
 	$(top_srcdir)/texk/makeindexk/ac/withenable.ac \
+	$(top_srcdir)/texk/makejvf/ac/withenable.ac \
+	$(top_srcdir)/texk/mendexk/ac/withenable.ac \
 	$(top_srcdir)/texk/musixflx/ac/withenable.ac \
 	$(top_srcdir)/texk/ps2pkm/ac/withenable.ac \
 	$(top_srcdir)/texk/seetexk/ac/withenable.ac \
Index: libs/configure
===================================================================
--- texlive-20091011-source.orig/libs/configure
+++ texlive-20091011-source/libs/configure
@@ -706,6 +706,7 @@
 enable_omfonts
 enable_tex
 enable_etex
+enable_ptex
 enable_aleph
 enable_pdftex
 enable_luatex
@@ -755,6 +756,8 @@
 enable_ttftotype42
 enable_updmap
 enable_makeindexk
+enable_makejvf
+enable_mendexk
 enable_musixflx
 enable_ps2pkm
 enable_seetexk
@@ -1475,6 +1478,7 @@
                             versions)
   --disable-tex             do not compile and install TeX
   --enable-etex             compile and install e-TeX
+  --disable-ptex            do not compile and install pTeX
   --disable-aleph           do not compile and install Aleph
   --disable-pdftex          do not compile and install pdfTeX
   --disable-luatex          do not compile and install luaTeX
@@ -1526,6 +1530,8 @@
   --disable-auto-t1dotlessj disable running t1dotlessj from otftotfm
   --disable-auto-updmap     disable running updmap from otftotfm
   --disable-makeindexk    do not build the makeindexk package
+  --disable-makejvf       do not build the makejvf package
+  --disable-mendexk       do not build the mendexk package
   --disable-musixflx      do not build the musixflx package
   --disable-ps2pkm        do not build the ps2pkm package
   --disable-seetexk       do not build the seetexk package
@@ -2404,6 +2410,10 @@
 
 
 
+## texk/ptexenc/ac/withenable.ac: configure.ac fragment for the TeX Live subdirectory texk/ptexenc/
+## configure options and TL libraries required for ptexenc
+
+
 ## texk/web2c/ac/withenable.ac: configure.ac fragment for the TeX Live subdirectory texk/web2c/
 ## configure options and TL libraries required for web2c
 # Check whether --enable-web2c was given.
@@ -2468,6 +2478,18 @@
   yes|no) : ;;
   *) enable_etex=no ;;
 esac
+# Check whether --enable-ptex was given.
+if test "${enable_ptex+set}" = set; then
+  enableval=$enable_ptex;
+fi
+case $enable_ptex in
+  yes|no) : ;;
+  *) enable_ptex=yes ;;
+esac
+
+test "x$enable_web2c:$enable_ptex" = xyes:yes && {
+  need_ptexenc=yes
+}
 # Check whether --enable-aleph was given.
 if test "${enable_aleph+set}" = set; then
   enableval=$enable_aleph;
@@ -2982,6 +3004,46 @@
 }
 
 
+## texk/makejvf/ac/withenable.ac: configure.ac fragment for the TeX Live subdirectory texk/makejvf/
+## configure options and TL libraries required for makeindexk
+# Check whether --enable-makejvf was given.
+if test "${enable_makejvf+set}" = set; then
+  enableval=$enable_makejvf;
+fi
+case $enable_makejvf in #(
+  yes|no);; #(
+  *) enable_makejvf=$enable_all_pkgs
+     { $as_echo "$as_me:$LINENO: Assuming \`--enable-makejvf=$enable_makejvf'" >&5
+$as_echo "$as_me: Assuming \`--enable-makejvf=$enable_makejvf'" >&6;}
+     ac_configure_args="$ac_configure_args '--enable-makejvf=$enable_makejvf'";;
+esac
+
+test "x$enable_makejvf" = xno || {
+  need_kpathsea=yes
+  need_ptexenc=yes
+}
+
+
+## texk/mendexk/ac/withenable.ac: configure.ac fragment for the TeX Live subdirectory texk/mendexk/
+## configure options and TL libraries required for makeindexk
+# Check whether --enable-mendexk was given.
+if test "${enable_mendexk+set}" = set; then
+  enableval=$enable_mendexk;
+fi
+case $enable_mendexk in #(
+  yes|no);; #(
+  *) enable_mendexk=$enable_all_pkgs
+     { $as_echo "$as_me:$LINENO: Assuming \`--enable-mendexk=$enable_mendexk'" >&5
+$as_echo "$as_me: Assuming \`--enable-mendexk=$enable_mendexk'" >&6;}
+     ac_configure_args="$ac_configure_args '--enable-mendexk=$enable_mendexk'";;
+esac
+
+test "x$enable_mendexk" = xno || {
+  need_kpathsea=yes
+  need_ptexenc=yes
+}
+
+
 ## texk/musixflx/ac/withenable.ac: configure.ac fragment for the TeX Live subdirectory texk/musixflx/
 ## configure options and TL libraries required for musixflx
 # Check whether --enable-musixflx was given.
@@ -2997,6 +3059,7 @@
 esac
 
 
+
 ## texk/ps2pkm/ac/withenable.ac: configure.ac fragment for the TeX Live subdirectory texk/ps2pkm/
 ## configure options and TL libraries required for ps2pkm
 # Check whether --enable-ps2pkm was given.
@@ -3016,6 +3079,7 @@
 }
 
 
+
 ## texk/seetexk/ac/withenable.ac: configure.ac fragment for the TeX Live subdirectory texk/seetexk/
 ## configure options and TL libraries required for seetexk
 # Check whether --enable-seetexk was given.
Index: libs/Makefile.in
===================================================================
--- texlive-20091011-source.orig/libs/Makefile.in
+++ texlive-20091011-source/libs/Makefile.in
@@ -73,6 +73,7 @@
 	$(top_srcdir)/../utils/vlna/ac/withenable.ac \
 	$(top_srcdir)/../utils/xindy/ac/withenable.ac \
 	$(top_srcdir)/../utils/xindy/ac/xindy.ac \
+	$(top_srcdir)/../texk/ptexenc/ac/withenable.ac \
 	$(top_srcdir)/../texk/web2c/ac/withenable.ac \
 	$(top_srcdir)/../texk/web2c/ac/web2c.ac \
 	$(top_srcdir)/../texk/afm2pl/ac/withenable.ac \
@@ -94,6 +95,8 @@
 	$(top_srcdir)/../texk/lcdf-typetools/ac/withenable.ac \
 	$(top_srcdir)/../texk/lcdf-typetools/ac/lcdf-typetools.ac \
 	$(top_srcdir)/../texk/makeindexk/ac/withenable.ac \
+	$(top_srcdir)/../texk/makejvf/ac/withenable.ac \
+	$(top_srcdir)/../texk/mendexk/ac/withenable.ac \
 	$(top_srcdir)/../texk/musixflx/ac/withenable.ac \
 	$(top_srcdir)/../texk/ps2pkm/ac/withenable.ac \
 	$(top_srcdir)/../texk/seetexk/ac/withenable.ac \
Index: utils/configure
===================================================================
--- texlive-20091011-source.orig/utils/configure
+++ texlive-20091011-source/utils/configure
@@ -706,6 +706,7 @@
 enable_omfonts
 enable_tex
 enable_etex
+enable_ptex
 enable_aleph
 enable_pdftex
 enable_luatex
@@ -755,6 +756,8 @@
 enable_ttftotype42
 enable_updmap
 enable_makeindexk
+enable_makejvf
+enable_mendexk
 enable_musixflx
 enable_ps2pkm
 enable_seetexk
@@ -1472,6 +1475,7 @@
                             versions)
   --disable-tex             do not compile and install TeX
   --enable-etex             compile and install e-TeX
+  --disable-ptex            do not compile and install pTeX
   --disable-aleph           do not compile and install Aleph
   --disable-pdftex          do not compile and install pdfTeX
   --disable-luatex          do not compile and install luaTeX
@@ -1523,6 +1527,8 @@
   --disable-auto-t1dotlessj disable running t1dotlessj from otftotfm
   --disable-auto-updmap     disable running updmap from otftotfm
   --disable-makeindexk    do not build the makeindexk package
+  --disable-makejvf       do not build the makejvf package
+  --disable-mendexk       do not build the mendexk package
   --disable-musixflx      do not build the musixflx package
   --disable-ps2pkm        do not build the ps2pkm package
   --disable-seetexk       do not build the seetexk package
@@ -2401,6 +2407,10 @@
 
 
 
+## texk/ptexenc/ac/withenable.ac: configure.ac fragment for the TeX Live subdirectory texk/ptexenc/
+## configure options and TL libraries required for ptexenc
+
+
 ## texk/web2c/ac/withenable.ac: configure.ac fragment for the TeX Live subdirectory texk/web2c/
 ## configure options and TL libraries required for web2c
 # Check whether --enable-web2c was given.
@@ -2465,6 +2475,18 @@
   yes|no) : ;;
   *) enable_etex=no ;;
 esac
+# Check whether --enable-ptex was given.
+if test "${enable_ptex+set}" = set; then
+  enableval=$enable_ptex;
+fi
+case $enable_ptex in
+  yes|no) : ;;
+  *) enable_ptex=yes ;;
+esac
+
+test "x$enable_web2c:$enable_ptex" = xyes:yes && {
+  need_ptexenc=yes
+}
 # Check whether --enable-aleph was given.
 if test "${enable_aleph+set}" = set; then
   enableval=$enable_aleph;
@@ -2979,6 +3001,46 @@
 }
 
 
+## texk/makejvf/ac/withenable.ac: configure.ac fragment for the TeX Live subdirectory texk/makejvf/
+## configure options and TL libraries required for makeindexk
+# Check whether --enable-makejvf was given.
+if test "${enable_makejvf+set}" = set; then
+  enableval=$enable_makejvf;
+fi
+case $enable_makejvf in #(
+  yes|no);; #(
+  *) enable_makejvf=$enable_all_pkgs
+     { $as_echo "$as_me:$LINENO: Assuming \`--enable-makejvf=$enable_makejvf'" >&5
+$as_echo "$as_me: Assuming \`--enable-makejvf=$enable_makejvf'" >&6;}
+     ac_configure_args="$ac_configure_args '--enable-makejvf=$enable_makejvf'";;
+esac
+
+test "x$enable_makejvf" = xno || {
+  need_kpathsea=yes
+  need_ptexenc=yes
+}
+
+
+## texk/mendexk/ac/withenable.ac: configure.ac fragment for the TeX Live subdirectory texk/mendexk/
+## configure options and TL libraries required for makeindexk
+# Check whether --enable-mendexk was given.
+if test "${enable_mendexk+set}" = set; then
+  enableval=$enable_mendexk;
+fi
+case $enable_mendexk in #(
+  yes|no);; #(
+  *) enable_mendexk=$enable_all_pkgs
+     { $as_echo "$as_me:$LINENO: Assuming \`--enable-mendexk=$enable_mendexk'" >&5
+$as_echo "$as_me: Assuming \`--enable-mendexk=$enable_mendexk'" >&6;}
+     ac_configure_args="$ac_configure_args '--enable-mendexk=$enable_mendexk'";;
+esac
+
+test "x$enable_mendexk" = xno || {
+  need_kpathsea=yes
+  need_ptexenc=yes
+}
+
+
 ## texk/musixflx/ac/withenable.ac: configure.ac fragment for the TeX Live subdirectory texk/musixflx/
 ## configure options and TL libraries required for musixflx
 # Check whether --enable-musixflx was given.
@@ -2994,6 +3056,7 @@
 esac
 
 
+
 ## texk/ps2pkm/ac/withenable.ac: configure.ac fragment for the TeX Live subdirectory texk/ps2pkm/
 ## configure options and TL libraries required for ps2pkm
 # Check whether --enable-ps2pkm was given.
@@ -3013,6 +3076,7 @@
 }
 
 
+
 ## texk/seetexk/ac/withenable.ac: configure.ac fragment for the TeX Live subdirectory texk/seetexk/
 ## configure options and TL libraries required for seetexk
 # Check whether --enable-seetexk was given.
Index: utils/Makefile.in
===================================================================
--- texlive-20091011-source.orig/utils/Makefile.in
+++ texlive-20091011-source/utils/Makefile.in
@@ -73,6 +73,7 @@
 	$(top_srcdir)/../utils/vlna/ac/withenable.ac \
 	$(top_srcdir)/../utils/xindy/ac/withenable.ac \
 	$(top_srcdir)/../utils/xindy/ac/xindy.ac \
+	$(top_srcdir)/../texk/ptexenc/ac/withenable.ac \
 	$(top_srcdir)/../texk/web2c/ac/withenable.ac \
 	$(top_srcdir)/../texk/web2c/ac/web2c.ac \
 	$(top_srcdir)/../texk/afm2pl/ac/withenable.ac \
@@ -94,6 +95,8 @@
 	$(top_srcdir)/../texk/lcdf-typetools/ac/withenable.ac \
 	$(top_srcdir)/../texk/lcdf-typetools/ac/lcdf-typetools.ac \
 	$(top_srcdir)/../texk/makeindexk/ac/withenable.ac \
+	$(top_srcdir)/../texk/makejvf/ac/withenable.ac \
+	$(top_srcdir)/../texk/mendexk/ac/withenable.ac \
 	$(top_srcdir)/../texk/musixflx/ac/withenable.ac \
 	$(top_srcdir)/../texk/ps2pkm/ac/withenable.ac \
 	$(top_srcdir)/../texk/seetexk/ac/withenable.ac \
Index: texk/configure
===================================================================
--- texlive-20091011-source.orig/texk/configure
+++ texlive-20091011-source/texk/configure
@@ -706,6 +706,7 @@
 enable_omfonts
 enable_tex
 enable_etex
+enable_ptex
 enable_aleph
 enable_pdftex
 enable_luatex
@@ -755,6 +756,8 @@
 enable_ttftotype42
 enable_updmap
 enable_makeindexk
+enable_makejvf
+enable_mendexk
 enable_musixflx
 enable_ps2pkm
 enable_seetexk
@@ -807,6 +810,7 @@
 host_alias
 target_alias'
 ac_subdirs_all='dummy
+ptexenc
 web2c
 afm2pl
 bibtex8
@@ -825,8 +829,12 @@
 lacheck
 lcdf-typetools
 makeindexk
+makejvf
+mendexk
 musixflx
+pdvipsk
 ps2pkm
+pxdvik
 seetexk
 tex4htk
 ttf2pk
@@ -1493,6 +1501,7 @@
                             versions)
   --disable-tex             do not compile and install TeX
   --enable-etex             compile and install e-TeX
+  --disable-ptex            do not compile and install pTeX
   --disable-aleph           do not compile and install Aleph
   --disable-pdftex          do not compile and install pdfTeX
   --disable-luatex          do not compile and install luaTeX
@@ -1544,6 +1553,8 @@
   --disable-auto-t1dotlessj disable running t1dotlessj from otftotfm
   --disable-auto-updmap     disable running updmap from otftotfm
   --disable-makeindexk    do not build the makeindexk package
+  --disable-makejvf       do not build the makejvf package
+  --disable-mendexk       do not build the mendexk package
   --disable-musixflx      do not build the musixflx package
   --disable-ps2pkm        do not build the ps2pkm package
   --disable-seetexk       do not build the seetexk package
@@ -2422,6 +2433,10 @@
 
 
 
+## texk/ptexenc/ac/withenable.ac: configure.ac fragment for the TeX Live subdirectory texk/ptexenc/
+## configure options and TL libraries required for ptexenc
+
+
 ## texk/web2c/ac/withenable.ac: configure.ac fragment for the TeX Live subdirectory texk/web2c/
 ## configure options and TL libraries required for web2c
 # Check whether --enable-web2c was given.
@@ -2486,6 +2501,18 @@
   yes|no) : ;;
   *) enable_etex=no ;;
 esac
+# Check whether --enable-ptex was given.
+if test "${enable_ptex+set}" = set; then
+  enableval=$enable_ptex;
+fi
+case $enable_ptex in
+  yes|no) : ;;
+  *) enable_ptex=yes ;;
+esac
+
+test "x$enable_web2c:$enable_ptex" = xyes:yes && {
+  need_ptexenc=yes
+}
 # Check whether --enable-aleph was given.
 if test "${enable_aleph+set}" = set; then
   enableval=$enable_aleph;
@@ -3000,6 +3027,46 @@
 }
 
 
+## texk/makejvf/ac/withenable.ac: configure.ac fragment for the TeX Live subdirectory texk/makejvf/
+## configure options and TL libraries required for makeindexk
+# Check whether --enable-makejvf was given.
+if test "${enable_makejvf+set}" = set; then
+  enableval=$enable_makejvf;
+fi
+case $enable_makejvf in #(
+  yes|no);; #(
+  *) enable_makejvf=$enable_all_pkgs
+     { $as_echo "$as_me:$LINENO: Assuming \`--enable-makejvf=$enable_makejvf'" >&5
+$as_echo "$as_me: Assuming \`--enable-makejvf=$enable_makejvf'" >&6;}
+     ac_configure_args="$ac_configure_args '--enable-makejvf=$enable_makejvf'";;
+esac
+
+test "x$enable_makejvf" = xno || {
+  need_kpathsea=yes
+  need_ptexenc=yes
+}
+
+
+## texk/mendexk/ac/withenable.ac: configure.ac fragment for the TeX Live subdirectory texk/mendexk/
+## configure options and TL libraries required for makeindexk
+# Check whether --enable-mendexk was given.
+if test "${enable_mendexk+set}" = set; then
+  enableval=$enable_mendexk;
+fi
+case $enable_mendexk in #(
+  yes|no);; #(
+  *) enable_mendexk=$enable_all_pkgs
+     { $as_echo "$as_me:$LINENO: Assuming \`--enable-mendexk=$enable_mendexk'" >&5
+$as_echo "$as_me: Assuming \`--enable-mendexk=$enable_mendexk'" >&6;}
+     ac_configure_args="$ac_configure_args '--enable-mendexk=$enable_mendexk'";;
+esac
+
+test "x$enable_mendexk" = xno || {
+  need_kpathsea=yes
+  need_ptexenc=yes
+}
+
+
 ## texk/musixflx/ac/withenable.ac: configure.ac fragment for the TeX Live subdirectory texk/musixflx/
 ## configure options and TL libraries required for musixflx
 # Check whether --enable-musixflx was given.
@@ -3015,6 +3082,7 @@
 esac
 
 
+
 ## texk/ps2pkm/ac/withenable.ac: configure.ac fragment for the TeX Live subdirectory texk/ps2pkm/
 ## configure options and TL libraries required for ps2pkm
 # Check whether --enable-ps2pkm was given.
@@ -3034,6 +3102,7 @@
 }
 
 
+
 ## texk/seetexk/ac/withenable.ac: configure.ac fragment for the TeX Live subdirectory texk/seetexk/
 ## configure options and TL libraries required for seetexk
 # Check whether --enable-seetexk was given.
@@ -4234,6 +4303,16 @@
 SUBTEXK=
 DIST_SUBTEXK=
 
+if test -x $srcdir/ptexenc/configure; then
+  test "x$enable_ptexenc" = xno || SUBTEXK="$SUBTEXK ptexenc"
+  DIST_SUBTEXK="$DIST_SUBTEXK ptexenc"
+  if false; then
+    subdirs="$subdirs ptexenc"
+
+  fi
+fi
+
+
 if test -x $srcdir/web2c/configure; then
   test "x$enable_web2c" = xno || SUBTEXK="$SUBTEXK web2c"
   DIST_SUBTEXK="$DIST_SUBTEXK web2c"
@@ -4414,6 +4493,26 @@
 fi
 
 
+if test -x $srcdir/makejvf/configure; then
+  test "x$enable_makejvf" = xno || SUBTEXK="$SUBTEXK makejvf"
+  DIST_SUBTEXK="$DIST_SUBTEXK makejvf"
+  if false; then
+    subdirs="$subdirs makejvf"
+
+  fi
+fi
+
+
+if test -x $srcdir/mendexk/configure; then
+  test "x$enable_mendexk" = xno || SUBTEXK="$SUBTEXK mendexk"
+  DIST_SUBTEXK="$DIST_SUBTEXK mendexk"
+  if false; then
+    subdirs="$subdirs mendexk"
+
+  fi
+fi
+
+
 if test -x $srcdir/musixflx/configure; then
   test "x$enable_musixflx" = xno || SUBTEXK="$SUBTEXK musixflx"
   DIST_SUBTEXK="$DIST_SUBTEXK musixflx"
@@ -4424,6 +4523,16 @@
 fi
 
 
+if test -x $srcdir/pdvipsk/configure; then
+  test "x$enable_pdvipsk" = xno || SUBTEXK="$SUBTEXK pdvipsk"
+  DIST_SUBTEXK="$DIST_SUBTEXK pdvipsk"
+  if false; then
+    subdirs="$subdirs pdvipsk"
+
+  fi
+fi
+
+
 if test -x $srcdir/ps2pkm/configure; then
   test "x$enable_ps2pkm" = xno || SUBTEXK="$SUBTEXK ps2pkm"
   DIST_SUBTEXK="$DIST_SUBTEXK ps2pkm"
@@ -4434,6 +4543,16 @@
 fi
 
 
+if test -x $srcdir/pxdvik/configure; then
+  test "x$enable_pxdvik" = xno || SUBTEXK="$SUBTEXK pxdvik"
+  DIST_SUBTEXK="$DIST_SUBTEXK pxdvik"
+  if false; then
+    subdirs="$subdirs pxdvik"
+
+  fi
+fi
+
+
 if test -x $srcdir/seetexk/configure; then
   test "x$enable_seetexk" = xno || SUBTEXK="$SUBTEXK seetexk"
   DIST_SUBTEXK="$DIST_SUBTEXK seetexk"
Index: texk/Makefile.in
===================================================================
--- texlive-20091011-source.orig/texk/Makefile.in
+++ texlive-20091011-source/texk/Makefile.in
@@ -73,6 +73,7 @@
 	$(top_srcdir)/../utils/vlna/ac/withenable.ac \
 	$(top_srcdir)/../utils/xindy/ac/withenable.ac \
 	$(top_srcdir)/../utils/xindy/ac/xindy.ac \
+	$(top_srcdir)/../texk/ptexenc/ac/withenable.ac \
 	$(top_srcdir)/../texk/web2c/ac/withenable.ac \
 	$(top_srcdir)/../texk/web2c/ac/web2c.ac \
 	$(top_srcdir)/../texk/afm2pl/ac/withenable.ac \
@@ -94,6 +95,8 @@
 	$(top_srcdir)/../texk/lcdf-typetools/ac/withenable.ac \
 	$(top_srcdir)/../texk/lcdf-typetools/ac/lcdf-typetools.ac \
 	$(top_srcdir)/../texk/makeindexk/ac/withenable.ac \
+	$(top_srcdir)/../texk/makejvf/ac/withenable.ac \
+	$(top_srcdir)/../texk/mendexk/ac/withenable.ac \
 	$(top_srcdir)/../texk/musixflx/ac/withenable.ac \
 	$(top_srcdir)/../texk/ps2pkm/ac/withenable.ac \
 	$(top_srcdir)/../texk/seetexk/ac/withenable.ac \
Index: texk/tetex/fmtutil.cnf
===================================================================
--- texlive-20091011-source.orig/texk/tetex/fmtutil.cnf
+++ texlive-20091011-source/texk/tetex/fmtutil.cnf
@@ -104,6 +104,10 @@
 # from phyzzx:
 phyzzx pdftex - physe.ini
 #
+# For pTeX (by hand):
+ptex	ptex	-		--kanji=default ptex.ini
+platex	ptex	language.dat	--kanji=default platex.ini
+#
 # from t2:
 #! cyramstex pdftex language.dat -translate-file=cp227.tcx *cyramstx.ini
 #! cyrtex pdftex language.dat -translate-file=cp227.tcx *cyrtex.ini
Index: texk/kpathsea/texmf.cnf
===================================================================
--- texlive-20091011-source.orig/texk/kpathsea/texmf.cnf
+++ texlive-20091011-source/texk/kpathsea/texmf.cnf
@@ -234,6 +234,14 @@
 TEXINPUTS.lamed         = .;$TEXMF/tex/{lamed,lambda,latex,generic,}//
 TEXINPUTS.omega         = .;$TEXMF/tex/{plain,generic,}//
 
+% pTeX
+TEXINPUTS.ptex    = .;$TEXMF/{ptex/{plain,generic},tex/{plain,generic,}}//
+TEXINPUTS.platex  = .;$TEXMF/{ptex/platex,{p,}tex/latex,{p,}tex/generic,{p,}tex}//
+
+% pBibTeX bibliographies and style files
+BIBINPUTS.pbibtex = .;$TEXMF/{pbibtex,bibtex}/bib//
+BSTINPUTS.pbibtex = .;$TEXMF/{pbibtex,bibtex}/bst//
+
 % ConTeXt.
 TEXINPUTS.context       = .;$TEXMF/tex/{context,plain,generic,}//
 
Index: texk/web2c/Makefile.in
===================================================================
--- texlive-20091011-source.orig/texk/web2c/Makefile.in
+++ texlive-20091011-source/texk/web2c/Makefile.in
@@ -35,24 +35,25 @@
 build_triplet = @build@
 host_triplet = @host@
 EXTRA_PROGRAMS = $(am__EXEEXT_1) tex$(EXEEXT) mf$(EXEEXT) \
-	mf-nowin$(EXEEXT) mpost$(EXEEXT) etex$(EXEEXT) pdftex$(EXEEXT) \
-	ttf2afm$(EXEEXT) pdftosrc$(EXEEXT) luatex$(EXEEXT) \
-	luatangle$(EXEEXT) xetex$(EXEEXT) $(am__EXEEXT_4) \
-	aleph$(EXEEXT)
+	mf-nowin$(EXEEXT) mpost$(EXEEXT) etex$(EXEEXT) ptex$(EXEEXT) \
+	pdftex$(EXEEXT) ttf2afm$(EXEEXT) pdftosrc$(EXEEXT) \
+	luatex$(EXEEXT) luatangle$(EXEEXT) xetex$(EXEEXT) \
+	$(am__EXEEXT_4) aleph$(EXEEXT)
 bin_PROGRAMS = tangle$(EXEEXT) ctangle$(EXEEXT) $(am__EXEEXT_5) \
 	ctie$(EXEEXT) cweave$(EXEEXT) tie$(EXEEXT) $(am__EXEEXT_6) \
 	$(am__EXEEXT_7) $(am__EXEEXT_8) $(am__EXEEXT_9) \
 	$(am__EXEEXT_10) $(am__EXEEXT_11) $(am__EXEEXT_12) \
 	$(am__EXEEXT_13) $(am__EXEEXT_14) $(am__EXEEXT_15) \
-	$(am__EXEEXT_16) synctex$(EXEEXT)
+	$(am__EXEEXT_16) $(am__EXEEXT_17) synctex$(EXEEXT)
 noinst_PROGRAMS = tangleboot$(EXEEXT) ctangleboot$(EXEEXT)
-check_PROGRAMS = $(am__EXEEXT_17) $(am__EXEEXT_18) $(am__EXEEXT_19) \
-	$(am__EXEEXT_20) $(am__EXEEXT_21) md5main$(EXEEXT)
-TESTS = tangle.test $(am__EXEEXT_24) ctiedir/ctie.test \
+check_PROGRAMS = $(am__EXEEXT_18) $(am__EXEEXT_19) $(am__EXEEXT_20) \
+	$(am__EXEEXT_21) $(am__EXEEXT_22) $(am__EXEEXT_23) \
+	md5main$(EXEEXT)
+TESTS = tangle.test $(am__EXEEXT_26) ctiedir/ctie.test \
 	cwebdir/cweave.test tiedir/tie.test $(am__append_4) \
 	$(am__append_8) $(am__append_11) $(am__append_14) \
-	$(am__append_19) $(am__append_35) $(am__append_36) \
-	libmd5/md5.test
+	$(am__append_17) $(am__append_22) $(am__append_38) \
+	$(am__append_39) libmd5/md5.test
 DIST_COMMON = README $(am__configure_deps) $(dist_man_MANS) \
 	$(srcdir)/../../build-aux/config.guess \
 	$(srcdir)/../../build-aux/config.sub \
@@ -79,7 +80,7 @@
 	$(srcdir)/pdftexdir/am/libpdftex.am \
 	$(srcdir)/pdftexdir/am/pdftex.am \
 	$(srcdir)/pdftexdir/am/pdftosrc.am \
-	$(srcdir)/pdftexdir/am/ttf2afm.am \
+	$(srcdir)/pdftexdir/am/ttf2afm.am $(srcdir)/ptexdir/am/ptex.am \
 	$(srcdir)/synctexdir/am/synctex.am \
 	$(srcdir)/xetexdir/am/xetex.am $(top_srcdir)/configure \
 	$(top_srcdir)/luatexdir/luafontloader/ff-config.in \
@@ -103,30 +104,33 @@
 @ETEX_TRUE@am__append_13 = etex
 @ETEX_TRUE@am__append_14 = $(etex_tests)
 @ETEX_TRUE@am__append_15 = dvitype pltotf tftopl
-@PDFTEX_TRUE@am__append_16 = pdftex ttf2afm pdftosrc
-@MINGW32_TRUE@am__append_17 = \
+@PTEX_TRUE@am__append_16 = ptex pbibtex pdvitype ptftopl ppltotf
+@PTEX_TRUE@am__append_17 = $(ptex_tests)
+@PTEX_TRUE@am__append_18 = pdvitype ppltotf ptftopl
+@PDFTEX_TRUE@am__append_19 = pdftex ttf2afm pdftosrc
+@MINGW32_TRUE@am__append_20 = \
 @MINGW32_TRUE@	pdftexdir/regex/regex.c \
 @MINGW32_TRUE@	pdftexdir/regex/regex.h
 
-@LUATEX_TRUE@am__append_18 = luatex luatangle
-@LUATEX_TRUE@am__append_19 = luatexdir/luatangle.test
-@MINGW32_FALSE@am__append_20 = -DLUA_USE_POSIX
-@XETEX_TRUE@am__append_21 = xetex
-@XETEX_MACOSX_TRUE@am__append_22 = -DXETEX_MAC
-@XETEX_MACOSX_TRUE@am__append_23 = libxetexmm.a
-@XETEX_MACOSX_FALSE@am__append_24 = -DXETEX_OTHER $(XPDF_INCLUDES) \
+@LUATEX_TRUE@am__append_21 = luatex luatangle
+@LUATEX_TRUE@am__append_22 = luatexdir/luatangle.test
+@MINGW32_FALSE@am__append_23 = -DLUA_USE_POSIX
+@XETEX_TRUE@am__append_24 = xetex
+@XETEX_MACOSX_TRUE@am__append_25 = -DXETEX_MAC
+@XETEX_MACOSX_TRUE@am__append_26 = libxetexmm.a
+@XETEX_MACOSX_FALSE@am__append_27 = -DXETEX_OTHER $(XPDF_INCLUDES) \
 @XETEX_MACOSX_FALSE@	$(LIBPNG_INCLUDES) $(FONTCONFIG_INCLUDES)
-@XETEX_MACOSX_FALSE@am__append_25 = $(XPDF_LIBS) $(LIBPNG_LIBS) $(FONTCONFIG_LIBS)
-@XETEX_MACOSX_FALSE@am__append_26 = $(XPDF_DEPEND) $(LIBPNG_DEPEND)
-@XETEX_GRAPHITE_TRUE@am__append_27 = -DXETEX_GRAPHITE $(GRAPHITE_INCLUDES)
-@XETEX_GRAPHITE_TRUE@am__append_28 = $(GRAPHITE_LIBS)
-@XETEX_GRAPHITE_TRUE@am__append_29 = $(GRAPHITE_DEPEND)
-@XETEX_MACOSX_TRUE@am__append_30 = \
+@XETEX_MACOSX_FALSE@am__append_28 = $(XPDF_LIBS) $(LIBPNG_LIBS) $(FONTCONFIG_LIBS)
+@XETEX_MACOSX_FALSE@am__append_29 = $(XPDF_DEPEND) $(LIBPNG_DEPEND)
+@XETEX_GRAPHITE_TRUE@am__append_30 = -DXETEX_GRAPHITE $(GRAPHITE_INCLUDES)
+@XETEX_GRAPHITE_TRUE@am__append_31 = $(GRAPHITE_LIBS)
+@XETEX_GRAPHITE_TRUE@am__append_32 = $(GRAPHITE_DEPEND)
+@XETEX_MACOSX_TRUE@am__append_33 = \
 @XETEX_MACOSX_TRUE@	xetexdir/XeTeXFontInst_Mac.cpp \
 @XETEX_MACOSX_TRUE@	xetexdir/XeTeXFontInst_Mac.h \
 @XETEX_MACOSX_TRUE@	xetexdir/XeTeX_mac.c
 
-@XETEX_MACOSX_FALSE@am__append_31 = \
+@XETEX_MACOSX_FALSE@am__append_34 = \
 @XETEX_MACOSX_FALSE@	xetexdir/XeTeXFontMgr_FC.cpp \
 @XETEX_MACOSX_FALSE@	xetexdir/XeTeXFontMgr_FC.h \
 @XETEX_MACOSX_FALSE@	xetexdir/XeTeX_pic.c \
@@ -143,32 +147,32 @@
 @XETEX_MACOSX_FALSE@	xetexdir/pngimage.c \
 @XETEX_MACOSX_FALSE@	xetexdir/pngimage.h
 
-@XETEX_GRAPHITE_TRUE@am__append_32 = \
+@XETEX_GRAPHITE_TRUE@am__append_35 = \
 @XETEX_GRAPHITE_TRUE@	xetexdir/XeTeXGrLayout.cpp \
 @XETEX_GRAPHITE_TRUE@	xetexdir/XeTeXGrLayout.h
 
-@OTANGLE_TRUE@am__append_33 = $(omegaware_tools)
-@OMFONTS_FALSE@@OTANGLE_TRUE@am__append_34 = $(omegaware_font_tools)
-@OTANGLE_TRUE@am__append_35 = omegaware/otangle.test
-@OMFONTS_FALSE@@OTANGLE_TRUE@am__append_36 = omegaware/level1.test omegaware/omfonts.test omegaware/specialhex.test
-@OTANGLE_TRUE@am__append_37 = pltotf tftopl
-@ALEPH_TRUE@am__append_38 = aleph
-@TEX_SYNCTEX_TRUE@am__append_39 = -I$(srcdir)/synctexdir $(ZLIB_INCLUDES)
-@TEX_SYNCTEX_TRUE@am__append_40 = $(ZLIB_LIBS)
-@TEX_SYNCTEX_TRUE@am__append_41 = \
+@OTANGLE_TRUE@am__append_36 = $(omegaware_tools)
+@OMFONTS_FALSE@@OTANGLE_TRUE@am__append_37 = $(omegaware_font_tools)
+@OTANGLE_TRUE@am__append_38 = omegaware/otangle.test
+@OMFONTS_FALSE@@OTANGLE_TRUE@am__append_39 = omegaware/level1.test omegaware/omfonts.test omegaware/specialhex.test
+@OTANGLE_TRUE@am__append_40 = pltotf tftopl
+@ALEPH_TRUE@am__append_41 = aleph
+@TEX_SYNCTEX_TRUE@am__append_42 = -I$(srcdir)/synctexdir $(ZLIB_INCLUDES)
+@TEX_SYNCTEX_TRUE@am__append_43 = $(ZLIB_LIBS)
+@TEX_SYNCTEX_TRUE@am__append_44 = \
 @TEX_SYNCTEX_TRUE@	synctex.c
 
-@ETEX_SYNCTEX_TRUE@am__append_42 = -I$(srcdir)/synctexdir $(ZLIB_INCLUDES)
-@ETEX_SYNCTEX_TRUE@am__append_43 = $(ZLIB_LIBS)
-@ETEX_SYNCTEX_TRUE@am__append_44 = \
+@ETEX_SYNCTEX_TRUE@am__append_45 = -I$(srcdir)/synctexdir $(ZLIB_INCLUDES)
+@ETEX_SYNCTEX_TRUE@am__append_46 = $(ZLIB_LIBS)
+@ETEX_SYNCTEX_TRUE@am__append_47 = \
 @ETEX_SYNCTEX_TRUE@	synctex-e.c
 
-@PDFTEX_SYNCTEX_TRUE@am__append_45 = -I$(srcdir)/synctexdir
-@PDFTEX_SYNCTEX_TRUE@am__append_46 = \
+@PDFTEX_SYNCTEX_TRUE@am__append_48 = -I$(srcdir)/synctexdir
+@PDFTEX_SYNCTEX_TRUE@am__append_49 = \
 @PDFTEX_SYNCTEX_TRUE@	synctex-pdf.c
 
-@XETEX_SYNCTEX_TRUE@am__append_47 = -I$(srcdir)/synctexdir
-@XETEX_SYNCTEX_TRUE@am__append_48 = \
+@XETEX_SYNCTEX_TRUE@am__append_50 = -I$(srcdir)/synctexdir
+@XETEX_SYNCTEX_TRUE@am__append_51 = \
 @XETEX_SYNCTEX_TRUE@	synctex-xe.c
 
 subdir = .
@@ -186,6 +190,7 @@
 	$(top_srcdir)/../../m4/kpse-libpng-flags.m4 \
 	$(top_srcdir)/../../m4/kpse-macos-framework.m4 \
 	$(top_srcdir)/../../m4/kpse-obsdcompat-flags.m4 \
+	$(top_srcdir)/../../m4/kpse-ptexenc-flags.m4 \
 	$(top_srcdir)/../../m4/kpse-socket-libs.m4 \
 	$(top_srcdir)/../../m4/kpse-teckit-flags.m4 \
 	$(top_srcdir)/../../m4/kpse-warnings.m4 \
@@ -453,22 +458,26 @@
 @MFN_TRUE@@MF_TRUE@am__EXEEXT_8 = mf-nowin$(EXEEXT)
 @MP_TRUE@am__EXEEXT_9 = mpost$(EXEEXT)
 @ETEX_TRUE@am__EXEEXT_10 = etex$(EXEEXT)
-@PDFTEX_TRUE@am__EXEEXT_11 = pdftex$(EXEEXT) ttf2afm$(EXEEXT) \
+@PTEX_TRUE@am__EXEEXT_11 = ptex$(EXEEXT) pbibtex$(EXEEXT) \
+@PTEX_TRUE@	pdvitype$(EXEEXT) ptftopl$(EXEEXT) ppltotf$(EXEEXT)
+@PDFTEX_TRUE@am__EXEEXT_12 = pdftex$(EXEEXT) ttf2afm$(EXEEXT) \
 @PDFTEX_TRUE@	pdftosrc$(EXEEXT)
-@LUATEX_TRUE@am__EXEEXT_12 = luatex$(EXEEXT) luatangle$(EXEEXT)
-@XETEX_TRUE@am__EXEEXT_13 = xetex$(EXEEXT)
-@OTANGLE_TRUE@am__EXEEXT_14 = $(am__EXEEXT_2)
-@OMFONTS_FALSE@@OTANGLE_TRUE@am__EXEEXT_15 = $(am__EXEEXT_3)
-@ALEPH_TRUE@am__EXEEXT_16 = aleph$(EXEEXT)
+@LUATEX_TRUE@am__EXEEXT_13 = luatex$(EXEEXT) luatangle$(EXEEXT)
+@XETEX_TRUE@am__EXEEXT_14 = xetex$(EXEEXT)
+@OTANGLE_TRUE@am__EXEEXT_15 = $(am__EXEEXT_2)
+@OMFONTS_FALSE@@OTANGLE_TRUE@am__EXEEXT_16 = $(am__EXEEXT_3)
+@ALEPH_TRUE@am__EXEEXT_17 = aleph$(EXEEXT)
 am__installdirs = "$(DESTDIR)$(bindir)" "$(DESTDIR)$(man1dir)" \
 	"$(DESTDIR)$(man5dir)"
-@TEX_TRUE@am__EXEEXT_17 = dvitype$(EXEEXT) pltotf$(EXEEXT) \
+@TEX_TRUE@am__EXEEXT_18 = dvitype$(EXEEXT) pltotf$(EXEEXT) \
 @TEX_TRUE@	tftopl$(EXEEXT)
-@MF_TRUE@am__EXEEXT_18 = gftype$(EXEEXT) tftopl$(EXEEXT)
-@MP_TRUE@am__EXEEXT_19 = pltotf$(EXEEXT) tftopl$(EXEEXT)
-@ETEX_TRUE@am__EXEEXT_20 = dvitype$(EXEEXT) pltotf$(EXEEXT) \
+@MF_TRUE@am__EXEEXT_19 = gftype$(EXEEXT) tftopl$(EXEEXT)
+@MP_TRUE@am__EXEEXT_20 = pltotf$(EXEEXT) tftopl$(EXEEXT)
+@ETEX_TRUE@am__EXEEXT_21 = dvitype$(EXEEXT) pltotf$(EXEEXT) \
 @ETEX_TRUE@	tftopl$(EXEEXT)
-@OTANGLE_TRUE@am__EXEEXT_21 = pltotf$(EXEEXT) tftopl$(EXEEXT)
+@PTEX_TRUE@am__EXEEXT_22 = pdvitype$(EXEEXT) ppltotf$(EXEEXT) \
+@PTEX_TRUE@	ptftopl$(EXEEXT)
+@OTANGLE_TRUE@am__EXEEXT_23 = pltotf$(EXEEXT) tftopl$(EXEEXT)
 PROGRAMS = $(bin_PROGRAMS) $(noinst_PROGRAMS)
 am_aleph_OBJECTS = aleph-aleph.$(OBJEXT) aleph-alephbis.$(OBJEXT)
 am__objects_9 = aleph-alephini.$(OBJEXT) aleph-aleph0.$(OBJEXT) \
@@ -598,6 +607,10 @@
 patgen_OBJECTS = $(nodist_patgen_OBJECTS)
 patgen_LDADD = $(LDADD)
 patgen_DEPENDENCIES = $(proglib) $(am__DEPENDENCIES_1)
+nodist_pbibtex_OBJECTS = pbibtex.$(OBJEXT)
+pbibtex_OBJECTS = $(nodist_pbibtex_OBJECTS)
+pbibtex_DEPENDENCIES = $(pproglib) $(am__DEPENDENCIES_1) \
+	$(am__DEPENDENCIES_2)
 am__dist_pdftex_SOURCES_DIST = synctexdir/synctex.h \
 	synctexdir/synctex-common.h synctexdir/synctex-pdftex.h
 dist_pdftex_OBJECTS =
@@ -612,6 +625,10 @@
 	$(am__DEPENDENCIES_1) $(am__DEPENDENCIES_1) libmd5.a
 am_pdftosrc_OBJECTS = pdftosrc-pdftosrc.$(OBJEXT)
 pdftosrc_OBJECTS = $(am_pdftosrc_OBJECTS)
+nodist_pdvitype_OBJECTS = pdvitype-pdvitype.$(OBJEXT)
+pdvitype_OBJECTS = $(nodist_pdvitype_OBJECTS)
+pdvitype_DEPENDENCIES = $(pproglib) $(am__DEPENDENCIES_1) \
+	$(am__DEPENDENCIES_2)
 nodist_pktogf_OBJECTS = pktogf.$(OBJEXT)
 pktogf_OBJECTS = $(nodist_pktogf_OBJECTS)
 pktogf_LDADD = $(LDADD)
@@ -628,6 +645,21 @@
 pooltype_OBJECTS = $(nodist_pooltype_OBJECTS)
 pooltype_LDADD = $(LDADD)
 pooltype_DEPENDENCIES = $(proglib) $(am__DEPENDENCIES_1)
+nodist_ppltotf_OBJECTS = ppltotf-ppltotf.$(OBJEXT)
+ppltotf_OBJECTS = $(nodist_ppltotf_OBJECTS)
+ppltotf_DEPENDENCIES = $(pproglib) $(am__DEPENDENCIES_1) \
+	$(am__DEPENDENCIES_2)
+am__objects_16 = ptex-ptexini.$(OBJEXT) ptex-ptex0.$(OBJEXT) \
+	ptex-ptex1.$(OBJEXT) ptex-ptex2.$(OBJEXT)
+nodist_ptex_OBJECTS = $(am__objects_16) ptex-ptex-pool.$(OBJEXT) \
+	ptex-ptexextra.$(OBJEXT) ptex-kanji.$(OBJEXT)
+ptex_OBJECTS = $(nodist_ptex_OBJECTS)
+ptex_DEPENDENCIES = $(pproglib) $(am__DEPENDENCIES_1) \
+	$(am__DEPENDENCIES_2) $(am__DEPENDENCIES_1)
+nodist_ptftopl_OBJECTS = ptftopl.$(OBJEXT)
+ptftopl_OBJECTS = $(nodist_ptftopl_OBJECTS)
+ptftopl_DEPENDENCIES = $(pproglib) $(am__DEPENDENCIES_1) \
+	$(am__DEPENDENCIES_2)
 am_synctex_OBJECTS = synctex-synctex_main.$(OBJEXT) \
 	synctex-synctex_parser.$(OBJEXT) \
 	synctex-synctex_parser_utils.$(OBJEXT)
@@ -643,11 +675,11 @@
 am__dist_tex_SOURCES_DIST = synctexdir/synctex.h \
 	synctexdir/synctex-common.h synctexdir/synctex-tex.h
 dist_tex_OBJECTS =
-am__objects_16 = tex-texini.$(OBJEXT) tex-tex0.$(OBJEXT) \
+am__objects_17 = tex-texini.$(OBJEXT) tex-tex0.$(OBJEXT) \
 	tex-tex1.$(OBJEXT) tex-tex2.$(OBJEXT)
-@TEX_SYNCTEX_TRUE@am__objects_17 = tex-synctex.$(OBJEXT)
-nodist_tex_OBJECTS = $(am__objects_16) tex-tex-pool.$(OBJEXT) \
-	tex-texextra.$(OBJEXT) $(am__objects_17)
+@TEX_SYNCTEX_TRUE@am__objects_18 = tex-synctex.$(OBJEXT)
+nodist_tex_OBJECTS = $(am__objects_17) tex-tex-pool.$(OBJEXT) \
+	tex-texextra.$(OBJEXT) $(am__objects_18)
 tex_OBJECTS = $(dist_tex_OBJECTS) $(nodist_tex_OBJECTS)
 @TEX_SYNCTEX_TRUE@am__DEPENDENCIES_7 = $(am__DEPENDENCIES_1)
 tex_DEPENDENCIES = $(am__DEPENDENCIES_2) $(am__DEPENDENCIES_1) \
@@ -679,11 +711,11 @@
 am__dist_xetex_SOURCES_DIST = synctexdir/synctex.h \
 	synctexdir/synctex-common.h synctexdir/synctex-xetex.h
 dist_xetex_OBJECTS =
-am__objects_18 = xetex-xetexini.$(OBJEXT) xetex-xetex0.$(OBJEXT) \
+am__objects_19 = xetex-xetexini.$(OBJEXT) xetex-xetex0.$(OBJEXT) \
 	xetex-xetex1.$(OBJEXT) xetex-xetex2.$(OBJEXT)
-@XETEX_SYNCTEX_TRUE@am__objects_19 = xetex-synctex-xe.$(OBJEXT)
-nodist_xetex_OBJECTS = $(am__objects_18) xetex-xetex_pool.$(OBJEXT) \
-	xetex-xetexextra.$(OBJEXT) $(am__objects_19)
+@XETEX_SYNCTEX_TRUE@am__objects_20 = xetex-synctex-xe.$(OBJEXT)
+nodist_xetex_OBJECTS = $(am__objects_19) xetex-xetex_pool.$(OBJEXT) \
+	xetex-xetexextra.$(OBJEXT) $(am__objects_20)
 xetex_OBJECTS = $(dist_xetex_OBJECTS) $(nodist_xetex_OBJECTS)
 @XETEX_MACOSX_FALSE@am__DEPENDENCIES_8 = $(am__DEPENDENCIES_1) \
 @XETEX_MACOSX_FALSE@	$(am__DEPENDENCIES_1) \
@@ -739,19 +771,21 @@
 	$(nodist_odvitype_SOURCES) $(nodist_ofm2opl_SOURCES) \
 	$(nodist_opl2ofm_SOURCES) $(nodist_otangle_SOURCES) \
 	$(nodist_ovf2ovp_SOURCES) $(nodist_ovp2ovf_SOURCES) \
-	$(nodist_patgen_SOURCES) $(dist_pdftex_SOURCES) \
-	$(nodist_pdftex_SOURCES) $(nodist_EXTRA_pdftex_SOURCES) \
-	$(pdftosrc_SOURCES) $(nodist_EXTRA_pdftosrc_SOURCES) \
+	$(nodist_patgen_SOURCES) $(nodist_pbibtex_SOURCES) \
+	$(dist_pdftex_SOURCES) $(nodist_pdftex_SOURCES) \
+	$(nodist_EXTRA_pdftex_SOURCES) $(pdftosrc_SOURCES) \
+	$(nodist_EXTRA_pdftosrc_SOURCES) $(nodist_pdvitype_SOURCES) \
 	$(nodist_pktogf_SOURCES) $(nodist_pktype_SOURCES) \
 	$(nodist_pltotf_SOURCES) $(nodist_pooltype_SOURCES) \
-	$(synctex_SOURCES) $(nodist_tangle_SOURCES) \
-	$(nodist_tangleboot_SOURCES) $(dist_tex_SOURCES) \
-	$(nodist_tex_SOURCES) $(nodist_tftopl_SOURCES) \
-	$(nodist_tie_SOURCES) $(ttf2afm_SOURCES) \
-	$(EXTRA_ttf2afm_SOURCES) $(nodist_vftovp_SOURCES) \
-	$(nodist_vptovf_SOURCES) $(nodist_weave_SOURCES) \
-	$(dist_xetex_SOURCES) $(nodist_xetex_SOURCES) \
-	$(nodist_EXTRA_xetex_SOURCES)
+	$(nodist_ppltotf_SOURCES) $(nodist_ptex_SOURCES) \
+	$(nodist_ptftopl_SOURCES) $(synctex_SOURCES) \
+	$(nodist_tangle_SOURCES) $(nodist_tangleboot_SOURCES) \
+	$(dist_tex_SOURCES) $(nodist_tex_SOURCES) \
+	$(nodist_tftopl_SOURCES) $(nodist_tie_SOURCES) \
+	$(ttf2afm_SOURCES) $(EXTRA_ttf2afm_SOURCES) \
+	$(nodist_vftovp_SOURCES) $(nodist_vptovf_SOURCES) \
+	$(nodist_weave_SOURCES) $(dist_xetex_SOURCES) \
+	$(nodist_xetex_SOURCES) $(nodist_EXTRA_xetex_SOURCES)
 DIST_SOURCES = $(libff_a_SOURCES) $(liblua51_a_SOURCES) \
 	$(libluamisc_a_SOURCES) $(EXTRA_libluamisc_a_SOURCES) \
 	$(libluasocket_a_SOURCES) $(libluatex_a_SOURCES) \
@@ -805,12 +839,12 @@
 CTAGS = ctags
 am__tty_colors = \
 red=; grn=; lgn=; blu=; std=
-am__EXEEXT_22 = bibtex.test dvicopy.test dvitype.test gftodvi.test \
+am__EXEEXT_24 = bibtex.test dvicopy.test dvitype.test gftodvi.test \
 	gftopk.test gftype.test mft.test patgen.test pktogf.test \
 	pktype.test pltotf.test pooltype.test tftopl.test vftovp.test \
 	vptovf.test weave.test
-am__EXEEXT_23 = $(am__EXEEXT_22)
-@WEB_TRUE@am__EXEEXT_24 = $(am__EXEEXT_23)
+am__EXEEXT_25 = $(am__EXEEXT_24)
+@WEB_TRUE@am__EXEEXT_26 = $(am__EXEEXT_25)
 DIST_SUBDIRS = $(SUBDIRS)
 DISTFILES = $(DIST_COMMON) $(DIST_SOURCES) $(TEXINFOS) $(EXTRA_DIST)
 distdir = $(PACKAGE)-$(VERSION)
@@ -939,6 +973,9 @@
 PACKAGE_VERSION = @PACKAGE_VERSION@
 PATH_SEPARATOR = @PATH_SEPARATOR@
 PKG_CONFIG = @PKG_CONFIG@
+PTEXENC_DEPEND = @PTEXENC_DEPEND@
+PTEXENC_INCLUDES = @PTEXENC_INCLUDES@
+PTEXENC_LIBS = @PTEXENC_LIBS@
 RANLIB = @RANLIB@
 SED = @SED@
 SET_MAKE = @SET_MAKE@
@@ -1029,7 +1066,7 @@
 ACLOCAL_AMFLAGS = -I ../../m4
 INCLUDES = -I$(top_builddir)/.. $(KPATHSEA_INCLUDES)
 version = $(WEB2CVERSION)
-SUBDIRS = doc lib man web2c . window omegafonts otps
+SUBDIRS = doc lib man web2c . window omegafonts otps ptexdir/lib
 proglib = lib/lib.a
 dist_man_MANS = synctexdir/man1/synctex.1 synctexdir/man5/synctex.5
 nodist_man_MANS = ctiedir/ctie.1 tiedir/tie.1
@@ -1091,7 +1128,18 @@
 	etexdir/etrip/etrip3.in etexdir/etrip/etripin.log \
 	etexdir/etrip/etripman.tex etexdir/etrip/texmf.cnf \
 	etexdir/etrip/trip2.in etexdir/etex.mak etexdir/etex.mk \
-	$(pdftex_ch_srcs) pdftexdir/pdftex.defines pdftexdir/pdftex.h \
+	$(ptex_web_srcs) $(ptex_ch_srcs) ptexdir/ptexextra.in \
+	lib/texmfmp.c tmf-pool.h ptexdir/ChangeLog ptexdir/INSTALL \
+	ptexdir/README ptexdir/ptex_gen.tex $(ptex_tests) \
+	ptexdir/ptrip/ptrip.diffs ptexdir/ptrip/ptrip.fot \
+	ptexdir/ptrip/ptrip.log ptexdir/ptrip/ptrip.out \
+	ptexdir/ptrip/ptrip.pl ptexdir/ptrip/ptrip.tex \
+	ptexdir/ptrip/ptrip.typ ptexdir/ptrip/ptrip1.in \
+	ptexdir/ptrip/ptrip2.in ptexdir/ptrip/ptrip3.in \
+	ptexdir/ptrip/ptripin.log ptexdir/ptrip/ptripman.tex \
+	ptexdir/ptrip/texmf.cnf ptexdir/ptrip/trip2.in \
+	ptexdir/ptex.mak ptexdir/ptex.mk $(pdftex_ch_srcs) \
+	pdftexdir/pdftex.defines pdftexdir/pdftex.h \
 	pdftexdir/pdftexextra.in pdftexdir/ChangeLog pdftexdir/NEWS \
 	pdftexdir/README pdftexdir/change-files.txt \
 	pdftexdir/pdftex.mak pdftexdir/pdftex.mk \
@@ -1265,6 +1313,8 @@
 	$(nodist_libmplib_a_SOURCES) mp-ctangle psout-ctangle \
 	svgout-ctangle $(nodist_etex_SOURCES) etex.web etex.ch \
 	etex-web2c etex.p etex.pool etex-tangle etexdir/etex.version \
+	$(nodist_ptex_SOURCES) ptex.web ptex.ch ptex-web2c ptex.p \
+	ptex.pool ptex-tangle ptexdir/ptex.version \
 	$(nodist_pdftex_SOURCES) pdftex.ch pdftex-web2c pdftex.p \
 	pdftex.pool pdftex-tangle pdftexdir/pdftex.version \
 	$(nodist_luatex_SOURCES) luatex-web2c luatex.p luatex.pool \
@@ -1334,14 +1384,14 @@
 nodist_ctie_SOURCES = ctie.c
 nodist_cweave_SOURCES = cweave.c cweb.c
 nodist_tie_SOURCES = tie.c
-tex_CPPFLAGS = $(am__append_39)
+tex_CPPFLAGS = $(am__append_42)
 
 # With --enable-ipc, TeX may need to link with -lsocket.
-tex_LDADD = $(LDADD) $(ipc_socketlibs) $(am__append_40)
+tex_LDADD = $(LDADD) $(ipc_socketlibs) $(am__append_43)
 
 # TeX C sources
 tex_c_h = texini.c tex0.c tex1.c tex2.c texcoerce.h texd.h
-nodist_tex_SOURCES = $(tex_c_h) tex-pool.c texextra.c $(am__append_41)
+nodist_tex_SOURCES = $(tex_c_h) tex-pool.c texextra.c $(am__append_44)
 tex_ch_srcs = \
 	tex.web \
 	tex.ch \
@@ -1380,15 +1430,15 @@
 svgout_c_h = mplibsvg.h mpsvgout.h svgout.c
 libmplib_web = mplibdir/mp.w mplibdir/psout.w mplibdir/svgout.w \
 	mplibdir/memio.w mplibdir/tfmin.w
-etex_CPPFLAGS = $(am__append_42)
+etex_CPPFLAGS = $(am__append_45)
 
 # With --enable-ipc, e-TeX may need to link with -lsocket.
-etex_LDADD = $(LDADD) $(ipc_socketlibs) $(am__append_43)
+etex_LDADD = $(LDADD) $(ipc_socketlibs) $(am__append_46)
 
 # e-TeX C sources
 etex_c_h = etexini.c etex0.c etex1.c etex2.c etexcoerce.h etexd.h
 nodist_etex_SOURCES = $(etex_c_h) etex-pool.c etexextra.c \
-	etexdir/etexextra.h $(am__append_44)
+	etexdir/etexextra.h $(am__append_47)
 etex_web_srcs = \
 	tex.web \
 	etexdir/etex.ch \
@@ -1403,6 +1453,44 @@
 	etexdir/etex-binpool.ch
 
 etex_tests = etexdir/etrip.test
+ptex_CPPFLAGS = $(PTEXENC_INCLUDES)
+
+# With --enable-ipc, pTeX may need to link with -lsocket.
+ptex_LDADD = $(pproglib) $(PTEXENC_LIBS) $(LDADD) $(ipc_socketlibs)
+pbibtex_LDADD = $(pproglib) $(PTEXENC_LIBS) $(LDADD)
+ptftopl_LDADD = $(pproglib) $(PTEXENC_LIBS) $(LDADD)
+ppltotf_LDADD = $(pproglib) $(PTEXENC_LIBS) $(LDADD)
+pdvitype_LDADD = $(pproglib) $(PTEXENC_LIBS) $(LDADD)
+pproglib = ptexdir/lib/lib.a
+
+# pTeX C sources
+ptex_c_h = ptexini.c ptex0.c ptex1.c ptex2.c ptexcoerce.h ptexd.h
+nodist_ptex_SOURCES = $(ptex_c_h) ptex-pool.c ptexextra.c ptexdir/ptexextra.h ptexdir/kanji.c ptexdir/kanji.h
+ptex_web_srcs = \
+	tex.web \
+	tex.ch
+
+ptex_ch_srcs = \
+	$(ptex_ch_synctex) \
+	ptexdir/ptex-base.ch \
+	ptexdir/ptex-include.ch \
+	tex-binpool.ch
+
+
+### pBibTeX
+nodist_pbibtex_SOURCES = pbibtex.c pbibtex.h
+
+### pDVItype
+nodist_pdvitype_SOURCES = pdvitype.c pdvitype.h
+pdvitype_CPPFLAGS = -DDHEX_CHAR_CODE
+
+### pTFtoPL
+nodist_ptftopl_SOURCES = ptftopl.c ptftopl.h
+
+### pPLtoTF
+nodist_ppltotf_SOURCES = ppltotf.c ppltotf.h
+ppltotf_CPPFLAGS = -DPRESERVE_PUTC
+ptex_tests = ptexdir/ptrip.test
 pdftex_cppflags = $(ZLIB_INCLUDES) $(LIBPNG_INCLUDES) $(XPDF_INCLUDES) \
 	$(OBSDCOMPAT_INCLUDES) -I$(srcdir)/libmd5 \
 	-I$(srcdir)/pdftexdir
@@ -1414,12 +1502,12 @@
 	$(XPDF_DEPEND) $(OBSDCOMPAT_DEPEND) libmd5.a
 nodist_EXTRA_pdftex_SOURCES = dummy.cxx
 pdf_tangle = WEBINPUTS=.:$(srcdir)/pdftexdir $(buildenv) $(TANGLE)
-pdftex_CPPFLAGS = $(pdftex_cppflags) $(am__append_45)
+pdftex_CPPFLAGS = $(pdftex_cppflags) $(am__append_48)
 pdftex_LDADD = libpdftex.a $(pdftex_ldadd) $(LDADD) $(ipc_socketlibs)
 pdftex_DEPENDENCIES = $(pdftex_dependencies) libpdftex.a
 pdftex_c_h = pdftexini.c pdftex0.c pdftex1.c pdftex2.c pdftex3.c pdftexcoerce.h pdftexd.h
 nodist_pdftex_SOURCES = $(pdftex_c_h) pdftex-pool.c pdftexextra.c \
-	pdftexdir/pdftexextra.h $(am__append_46)
+	pdftexdir/pdftexextra.h $(am__append_49)
 pdftex_ch_srcs = \
 	pdftexdir/pdftex.web \
 	pdftexdir/tex.ch0 \
@@ -1439,7 +1527,7 @@
 	pdftexdir/writejbig2.h pdftexdir/writejpg.c \
 	pdftexdir/writepng.c pdftexdir/writet1.c pdftexdir/writet3.c \
 	pdftexdir/writettf.c pdftexdir/writettf.h pdftexdir/writezip.c \
-	$(am__append_17)
+	$(am__append_20)
 EXTRA_libpdftex_a_SOURCES = pdftexdir/macnames.c \
 	pdftexdir/regex/regcomp.c pdftexdir/regex/regex_internal.c \
 	pdftexdir/regex/regex_internal.h pdftexdir/regex/regexec.c
@@ -1469,7 +1557,7 @@
 luatex_sources = luatexdir/luatex.web luatexdir/luatex.ch
 nodist_luatangle_SOURCES = luatangle.c luatangle.h
 luatangle_sources = luatexdir/luatangle.web luatexdir/luatangle.ch
-liblua51_a_CPPFLAGS = -I$(top_srcdir)/luatexdir/lua51 $(am__append_20)
+liblua51_a_CPPFLAGS = -I$(top_srcdir)/luatexdir/lua51 $(am__append_23)
 liblua51_a_SOURCES = \
 	luatexdir/lua51/lapi.c \
 	luatexdir/lua51/lapi.h \
@@ -1851,23 +1939,23 @@
 
 EXTRA_libluatex_a_SOURCES = luatexdir/font/macnames.c
 nodist_EXTRA_xetex_SOURCES = dummy.cxx
-libxetex = libxetex.a $(am__append_23)
+libxetex = libxetex.a $(am__append_26)
 xetex_cppflags = -DU_STATIC_IMPLEMENTATION -I$(srcdir)/xetexdir \
 	$(ICU_INCLUDES) $(FREETYPE2_INCLUDES) $(TECKIT_INCLUDES) \
-	$(am__append_22) $(am__append_24) $(am__append_27) \
+	$(am__append_25) $(am__append_27) $(am__append_30) \
 	$(ZLIB_INCLUDES)
-xetex_ldadd = $(libxetex) $(ICU_LIBS) $(TECKIT_LIBS) $(am__append_25) \
-	$(am__append_28) $(FREETYPE2_LIBS) $(ZLIB_LIBS)
+xetex_ldadd = $(libxetex) $(ICU_LIBS) $(TECKIT_LIBS) $(am__append_28) \
+	$(am__append_31) $(FREETYPE2_LIBS) $(ZLIB_LIBS)
 xetex_dependencies = $(proglib) $(ICU_DEPEND) $(TECKIT_DEPEND) \
-	$(am__append_26) $(am__append_29) $(FREETYPE2_DEPEND) \
+	$(am__append_29) $(am__append_32) $(FREETYPE2_DEPEND) \
 	$(ZLIB_DEPEND)
 @XETEX_MACOSX_TRUE@xetex_LDFLAGS = -framework Carbon -framework Cocoa -framework QuickTime
-xetex_CPPFLAGS = $(xetex_cppflags) $(am__append_47)
+xetex_CPPFLAGS = $(xetex_cppflags) $(am__append_50)
 xetex_LDADD = $(xetex_ldadd) $(LDADD) $(ipc_socketlibs)
 xetex_DEPENDENCIES = $(xetex_dependencies) $(libxetex)
 xetex_c_h = xetexini.c xetex0.c xetex1.c xetex2.c xetexcoerce.h xetexd.h
 nodist_xetex_SOURCES = $(xetex_c_h) xetex_pool.c xetexextra.c \
-	xetexdir/xetexextra.h $(am__append_48)
+	xetexdir/xetexextra.h $(am__append_51)
 xetex_web_srcs = \
 	tex.web \
 	etexdir/etex.ch \
@@ -1892,8 +1980,8 @@
 	xetexdir/XeTeXOTMath.h xetexdir/XeTeX_ext.c \
 	xetexdir/XeTeX_ext.h xetexdir/XeTeXswap.h xetexdir/cmaps.cpp \
 	xetexdir/cmaps.h xetexdir/sfnt.h xetexdir/trans.c \
-	xetexdir/trans.h xetexdir/xetex.h $(am__append_30) \
-	$(am__append_31) $(am__append_32)
+	xetexdir/trans.h xetexdir/xetex.h $(am__append_33) \
+	$(am__append_34) $(am__append_35)
 libxetexmm_a_CPPFLAGS = $(xetex_cppflags)
 libxetexmm_a_CXXFLAGS = -ObjC++
 libxetexmm_a_SOURCES = \
@@ -2060,7 +2148,7 @@
 .SUFFIXES: .c .cc .cpp .cxx .lo .o .obj
 am--refresh:
 	@:
-$(srcdir)/Makefile.in: @MAINTAINER_MODE_TRUE@ $(srcdir)/Makefile.am $(srcdir)/am/bootstrap.am $(srcdir)/am/web.am $(srcdir)/am/cweb.am $(srcdir)/am/texmf.am $(srcdir)/mplibdir/am/mplib.am $(srcdir)/mplibdir/am/libmplib.am $(srcdir)/etexdir/am/etex.am $(srcdir)/pdftexdir/am/pdftex.am $(srcdir)/pdftexdir/am/libpdftex.am $(srcdir)/pdftexdir/am/ttf2afm.am $(srcdir)/pdftexdir/am/pdftosrc.am $(srcdir)/luatexdir/am/luatex.am $(srcdir)/luatexdir/am/luatangle.am $(srcdir)/luatexdir/am/liblua51.am $(srcdir)/luatexdir/am/libzzip.am $(srcdir)/luatexdir/am/luasocket.am $(srcdir)/luatexdir/am/luamisc.am $(srcdir)/luatexdir/am/luafontforge.am $(srcdir)/luatexdir/am/libluatex.am $(srcdir)/xetexdir/am/xetex.am $(srcdir)/omegaware/am/omegaware.am $(srcdir)/alephdir/am/aleph.am $(srcdir)/synctexdir/am/synctex.am $(srcdir)/libmd5/am/md5.am $(am__configure_deps)
+$(srcdir)/Makefile.in: @MAINTAINER_MODE_TRUE@ $(srcdir)/Makefile.am $(srcdir)/am/bootstrap.am $(srcdir)/am/web.am $(srcdir)/am/cweb.am $(srcdir)/am/texmf.am $(srcdir)/mplibdir/am/mplib.am $(srcdir)/mplibdir/am/libmplib.am $(srcdir)/etexdir/am/etex.am $(srcdir)/ptexdir/am/ptex.am $(srcdir)/pdftexdir/am/pdftex.am $(srcdir)/pdftexdir/am/libpdftex.am $(srcdir)/pdftexdir/am/ttf2afm.am $(srcdir)/pdftexdir/am/pdftosrc.am $(srcdir)/luatexdir/am/luatex.am $(srcdir)/luatexdir/am/luatangle.am $(srcdir)/luatexdir/am/liblua51.am $(srcdir)/luatexdir/am/libzzip.am $(srcdir)/luatexdir/am/luasocket.am $(srcdir)/luatexdir/am/luamisc.am $(srcdir)/luatexdir/am/luafontforge.am $(srcdir)/luatexdir/am/libluatex.am $(srcdir)/xetexdir/am/xetex.am $(srcdir)/omegaware/am/omegaware.am $(srcdir)/alephdir/am/aleph.am $(srcdir)/synctexdir/am/synctex.am $(srcdir)/libmd5/am/md5.am $(am__configure_deps)
 	@for dep in $?; do \
 	  case '$(am__configure_deps)' in \
 	    *$$dep*) \
@@ -2310,12 +2398,18 @@
 patgen$(EXEEXT): $(patgen_OBJECTS) $(patgen_DEPENDENCIES) 
 	@rm -f patgen$(EXEEXT)
 	$(LINK) $(patgen_OBJECTS) $(patgen_LDADD) $(LIBS)
+pbibtex$(EXEEXT): $(pbibtex_OBJECTS) $(pbibtex_DEPENDENCIES) 
+	@rm -f pbibtex$(EXEEXT)
+	$(LINK) $(pbibtex_OBJECTS) $(pbibtex_LDADD) $(LIBS)
 pdftex$(EXEEXT): $(pdftex_OBJECTS) $(pdftex_DEPENDENCIES) 
 	@rm -f pdftex$(EXEEXT)
 	$(CXXLINK) $(pdftex_OBJECTS) $(pdftex_LDADD) $(LIBS)
 pdftosrc$(EXEEXT): $(pdftosrc_OBJECTS) $(pdftosrc_DEPENDENCIES) 
 	@rm -f pdftosrc$(EXEEXT)
 	$(CXXLINK) $(pdftosrc_OBJECTS) $(pdftosrc_LDADD) $(LIBS)
+pdvitype$(EXEEXT): $(pdvitype_OBJECTS) $(pdvitype_DEPENDENCIES) 
+	@rm -f pdvitype$(EXEEXT)
+	$(LINK) $(pdvitype_OBJECTS) $(pdvitype_LDADD) $(LIBS)
 pktogf$(EXEEXT): $(pktogf_OBJECTS) $(pktogf_DEPENDENCIES) 
 	@rm -f pktogf$(EXEEXT)
 	$(LINK) $(pktogf_OBJECTS) $(pktogf_LDADD) $(LIBS)
@@ -2328,6 +2422,15 @@
 pooltype$(EXEEXT): $(pooltype_OBJECTS) $(pooltype_DEPENDENCIES) 
 	@rm -f pooltype$(EXEEXT)
 	$(LINK) $(pooltype_OBJECTS) $(pooltype_LDADD) $(LIBS)
+ppltotf$(EXEEXT): $(ppltotf_OBJECTS) $(ppltotf_DEPENDENCIES) 
+	@rm -f ppltotf$(EXEEXT)
+	$(LINK) $(ppltotf_OBJECTS) $(ppltotf_LDADD) $(LIBS)
+ptex$(EXEEXT): $(ptex_OBJECTS) $(ptex_DEPENDENCIES) 
+	@rm -f ptex$(EXEEXT)
+	$(LINK) $(ptex_OBJECTS) $(ptex_LDADD) $(LIBS)
+ptftopl$(EXEEXT): $(ptftopl_OBJECTS) $(ptftopl_DEPENDENCIES) 
+	@rm -f ptftopl$(EXEEXT)
+	$(LINK) $(ptftopl_OBJECTS) $(ptftopl_LDADD) $(LIBS)
 synctex$(EXEEXT): $(synctex_OBJECTS) $(synctex_DEPENDENCIES) 
 	@rm -f synctex$(EXEEXT)
 	$(LINK) $(synctex_OBJECTS) $(synctex_LDADD) $(LIBS)
@@ -2673,6 +2776,7 @@
 @AMDEP_TRUE@@am__include@ @am__quote@./$(DEPDIR)/ovf2ovp.Po@am__quote@
 @AMDEP_TRUE@@am__include@ @am__quote@./$(DEPDIR)/ovp2ovf.Po@am__quote@
 @AMDEP_TRUE@@am__include@ @am__quote@./$(DEPDIR)/patgen.Po@am__quote@
+@AMDEP_TRUE@@am__include@ @am__quote@./$(DEPDIR)/pbibtex.Po@am__quote@
 @AMDEP_TRUE@@am__include@ @am__quote@./$(DEPDIR)/pdftex-dummy.Po@am__quote@
 @AMDEP_TRUE@@am__include@ @am__quote@./$(DEPDIR)/pdftex-pdftex-pool.Po@am__quote@
 @AMDEP_TRUE@@am__include@ @am__quote@./$(DEPDIR)/pdftex-pdftex0.Po@am__quote@
@@ -2684,10 +2788,20 @@
 @AMDEP_TRUE@@am__include@ @am__quote@./$(DEPDIR)/pdftex-synctex-pdf.Po@am__quote@
 @AMDEP_TRUE@@am__include@ @am__quote@./$(DEPDIR)/pdftosrc-dummy.Po@am__quote@
 @AMDEP_TRUE@@am__include@ @am__quote@./$(DEPDIR)/pdftosrc-pdftosrc.Po@am__quote@
+@AMDEP_TRUE@@am__include@ @am__quote@./$(DEPDIR)/pdvitype-pdvitype.Po@am__quote@
 @AMDEP_TRUE@@am__include@ @am__quote@./$(DEPDIR)/pktogf.Po@am__quote@
 @AMDEP_TRUE@@am__include@ @am__quote@./$(DEPDIR)/pktype.Po@am__quote@
 @AMDEP_TRUE@@am__include@ @am__quote@./$(DEPDIR)/pltotf.Po@am__quote@
 @AMDEP_TRUE@@am__include@ @am__quote@./$(DEPDIR)/pooltype.Po@am__quote@
+@AMDEP_TRUE@@am__include@ @am__quote@./$(DEPDIR)/ppltotf-ppltotf.Po@am__quote@
+@AMDEP_TRUE@@am__include@ @am__quote@./$(DEPDIR)/ptex-kanji.Po@am__quote@
+@AMDEP_TRUE@@am__include@ @am__quote@./$(DEPDIR)/ptex-ptex-pool.Po@am__quote@
+@AMDEP_TRUE@@am__include@ @am__quote@./$(DEPDIR)/ptex-ptex0.Po@am__quote@
+@AMDEP_TRUE@@am__include@ @am__quote@./$(DEPDIR)/ptex-ptex1.Po@am__quote@
+@AMDEP_TRUE@@am__include@ @am__quote@./$(DEPDIR)/ptex-ptex2.Po@am__quote@
+@AMDEP_TRUE@@am__include@ @am__quote@./$(DEPDIR)/ptex-ptexextra.Po@am__quote@
+@AMDEP_TRUE@@am__include@ @am__quote@./$(DEPDIR)/ptex-ptexini.Po@am__quote@
+@AMDEP_TRUE@@am__include@ @am__quote@./$(DEPDIR)/ptftopl.Po@am__quote@
 @AMDEP_TRUE@@am__include@ @am__quote@./$(DEPDIR)/synctex-synctex_main.Po@am__quote@
 @AMDEP_TRUE@@am__include@ @am__quote@./$(DEPDIR)/synctex-synctex_parser.Po@am__quote@
 @AMDEP_TRUE@@am__include@ @am__quote@./$(DEPDIR)/synctex-synctex_parser_utils.Po@am__quote@
@@ -6587,6 +6701,132 @@
 @AMDEP_TRUE@@am__fastdepCC_FALSE@	DEPDIR=$(DEPDIR) $(CCDEPMODE) $(depcomp) @AMDEPBACKSLASH@
 @am__fastdepCC_FALSE@	$(CC) $(DEFS) $(DEFAULT_INCLUDES) $(INCLUDES) $(pdftex_CPPFLAGS) $(CPPFLAGS) $(AM_CFLAGS) $(CFLAGS) -c -o pdftex-synctex-pdf.obj `if test -f 'synctex-pdf.c'; then $(CYGPATH_W) 'synctex-pdf.c'; else $(CYGPATH_W) '$(srcdir)/synctex-pdf.c'; fi`
 
+pdvitype-pdvitype.o: pdvitype.c
+@am__fastdepCC_TRUE@	$(CC) $(DEFS) $(DEFAULT_INCLUDES) $(INCLUDES) $(pdvitype_CPPFLAGS) $(CPPFLAGS) $(AM_CFLAGS) $(CFLAGS) -MT pdvitype-pdvitype.o -MD -MP -MF $(DEPDIR)/pdvitype-pdvitype.Tpo -c -o pdvitype-pdvitype.o `test -f 'pdvitype.c' || echo '$(srcdir)/'`pdvitype.c
+@am__fastdepCC_TRUE@	$(am__mv) $(DEPDIR)/pdvitype-pdvitype.Tpo $(DEPDIR)/pdvitype-pdvitype.Po
+@AMDEP_TRUE@@am__fastdepCC_FALSE@	source='pdvitype.c' object='pdvitype-pdvitype.o' libtool=no @AMDEPBACKSLASH@
+@AMDEP_TRUE@@am__fastdepCC_FALSE@	DEPDIR=$(DEPDIR) $(CCDEPMODE) $(depcomp) @AMDEPBACKSLASH@
+@am__fastdepCC_FALSE@	$(CC) $(DEFS) $(DEFAULT_INCLUDES) $(INCLUDES) $(pdvitype_CPPFLAGS) $(CPPFLAGS) $(AM_CFLAGS) $(CFLAGS) -c -o pdvitype-pdvitype.o `test -f 'pdvitype.c' || echo '$(srcdir)/'`pdvitype.c
+
+pdvitype-pdvitype.obj: pdvitype.c
+@am__fastdepCC_TRUE@	$(CC) $(DEFS) $(DEFAULT_INCLUDES) $(INCLUDES) $(pdvitype_CPPFLAGS) $(CPPFLAGS) $(AM_CFLAGS) $(CFLAGS) -MT pdvitype-pdvitype.obj -MD -MP -MF $(DEPDIR)/pdvitype-pdvitype.Tpo -c -o pdvitype-pdvitype.obj `if test -f 'pdvitype.c'; then $(CYGPATH_W) 'pdvitype.c'; else $(CYGPATH_W) '$(srcdir)/pdvitype.c'; fi`
+@am__fastdepCC_TRUE@	$(am__mv) $(DEPDIR)/pdvitype-pdvitype.Tpo $(DEPDIR)/pdvitype-pdvitype.Po
+@AMDEP_TRUE@@am__fastdepCC_FALSE@	source='pdvitype.c' object='pdvitype-pdvitype.obj' libtool=no @AMDEPBACKSLASH@
+@AMDEP_TRUE@@am__fastdepCC_FALSE@	DEPDIR=$(DEPDIR) $(CCDEPMODE) $(depcomp) @AMDEPBACKSLASH@
+@am__fastdepCC_FALSE@	$(CC) $(DEFS) $(DEFAULT_INCLUDES) $(INCLUDES) $(pdvitype_CPPFLAGS) $(CPPFLAGS) $(AM_CFLAGS) $(CFLAGS) -c -o pdvitype-pdvitype.obj `if test -f 'pdvitype.c'; then $(CYGPATH_W) 'pdvitype.c'; else $(CYGPATH_W) '$(srcdir)/pdvitype.c'; fi`
+
+ppltotf-ppltotf.o: ppltotf.c
+@am__fastdepCC_TRUE@	$(CC) $(DEFS) $(DEFAULT_INCLUDES) $(INCLUDES) $(ppltotf_CPPFLAGS) $(CPPFLAGS) $(AM_CFLAGS) $(CFLAGS) -MT ppltotf-ppltotf.o -MD -MP -MF $(DEPDIR)/ppltotf-ppltotf.Tpo -c -o ppltotf-ppltotf.o `test -f 'ppltotf.c' || echo '$(srcdir)/'`ppltotf.c
+@am__fastdepCC_TRUE@	$(am__mv) $(DEPDIR)/ppltotf-ppltotf.Tpo $(DEPDIR)/ppltotf-ppltotf.Po
+@AMDEP_TRUE@@am__fastdepCC_FALSE@	source='ppltotf.c' object='ppltotf-ppltotf.o' libtool=no @AMDEPBACKSLASH@
+@AMDEP_TRUE@@am__fastdepCC_FALSE@	DEPDIR=$(DEPDIR) $(CCDEPMODE) $(depcomp) @AMDEPBACKSLASH@
+@am__fastdepCC_FALSE@	$(CC) $(DEFS) $(DEFAULT_INCLUDES) $(INCLUDES) $(ppltotf_CPPFLAGS) $(CPPFLAGS) $(AM_CFLAGS) $(CFLAGS) -c -o ppltotf-ppltotf.o `test -f 'ppltotf.c' || echo '$(srcdir)/'`ppltotf.c
+
+ppltotf-ppltotf.obj: ppltotf.c
+@am__fastdepCC_TRUE@	$(CC) $(DEFS) $(DEFAULT_INCLUDES) $(INCLUDES) $(ppltotf_CPPFLAGS) $(CPPFLAGS) $(AM_CFLAGS) $(CFLAGS) -MT ppltotf-ppltotf.obj -MD -MP -MF $(DEPDIR)/ppltotf-ppltotf.Tpo -c -o ppltotf-ppltotf.obj `if test -f 'ppltotf.c'; then $(CYGPATH_W) 'ppltotf.c'; else $(CYGPATH_W) '$(srcdir)/ppltotf.c'; fi`
+@am__fastdepCC_TRUE@	$(am__mv) $(DEPDIR)/ppltotf-ppltotf.Tpo $(DEPDIR)/ppltotf-ppltotf.Po
+@AMDEP_TRUE@@am__fastdepCC_FALSE@	source='ppltotf.c' object='ppltotf-ppltotf.obj' libtool=no @AMDEPBACKSLASH@
+@AMDEP_TRUE@@am__fastdepCC_FALSE@	DEPDIR=$(DEPDIR) $(CCDEPMODE) $(depcomp) @AMDEPBACKSLASH@
+@am__fastdepCC_FALSE@	$(CC) $(DEFS) $(DEFAULT_INCLUDES) $(INCLUDES) $(ppltotf_CPPFLAGS) $(CPPFLAGS) $(AM_CFLAGS) $(CFLAGS) -c -o ppltotf-ppltotf.obj `if test -f 'ppltotf.c'; then $(CYGPATH_W) 'ppltotf.c'; else $(CYGPATH_W) '$(srcdir)/ppltotf.c'; fi`
+
+ptex-ptexini.o: ptexini.c
+@am__fastdepCC_TRUE@	$(CC) $(DEFS) $(DEFAULT_INCLUDES) $(INCLUDES) $(ptex_CPPFLAGS) $(CPPFLAGS) $(AM_CFLAGS) $(CFLAGS) -MT ptex-ptexini.o -MD -MP -MF $(DEPDIR)/ptex-ptexini.Tpo -c -o ptex-ptexini.o `test -f 'ptexini.c' || echo '$(srcdir)/'`ptexini.c
+@am__fastdepCC_TRUE@	$(am__mv) $(DEPDIR)/ptex-ptexini.Tpo $(DEPDIR)/ptex-ptexini.Po
+@AMDEP_TRUE@@am__fastdepCC_FALSE@	source='ptexini.c' object='ptex-ptexini.o' libtool=no @AMDEPBACKSLASH@
+@AMDEP_TRUE@@am__fastdepCC_FALSE@	DEPDIR=$(DEPDIR) $(CCDEPMODE) $(depcomp) @AMDEPBACKSLASH@
+@am__fastdepCC_FALSE@	$(CC) $(DEFS) $(DEFAULT_INCLUDES) $(INCLUDES) $(ptex_CPPFLAGS) $(CPPFLAGS) $(AM_CFLAGS) $(CFLAGS) -c -o ptex-ptexini.o `test -f 'ptexini.c' || echo '$(srcdir)/'`ptexini.c
+
+ptex-ptexini.obj: ptexini.c
+@am__fastdepCC_TRUE@	$(CC) $(DEFS) $(DEFAULT_INCLUDES) $(INCLUDES) $(ptex_CPPFLAGS) $(CPPFLAGS) $(AM_CFLAGS) $(CFLAGS) -MT ptex-ptexini.obj -MD -MP -MF $(DEPDIR)/ptex-ptexini.Tpo -c -o ptex-ptexini.obj `if test -f 'ptexini.c'; then $(CYGPATH_W) 'ptexini.c'; else $(CYGPATH_W) '$(srcdir)/ptexini.c'; fi`
+@am__fastdepCC_TRUE@	$(am__mv) $(DEPDIR)/ptex-ptexini.Tpo $(DEPDIR)/ptex-ptexini.Po
+@AMDEP_TRUE@@am__fastdepCC_FALSE@	source='ptexini.c' object='ptex-ptexini.obj' libtool=no @AMDEPBACKSLASH@
+@AMDEP_TRUE@@am__fastdepCC_FALSE@	DEPDIR=$(DEPDIR) $(CCDEPMODE) $(depcomp) @AMDEPBACKSLASH@
+@am__fastdepCC_FALSE@	$(CC) $(DEFS) $(DEFAULT_INCLUDES) $(INCLUDES) $(ptex_CPPFLAGS) $(CPPFLAGS) $(AM_CFLAGS) $(CFLAGS) -c -o ptex-ptexini.obj `if test -f 'ptexini.c'; then $(CYGPATH_W) 'ptexini.c'; else $(CYGPATH_W) '$(srcdir)/ptexini.c'; fi`
+
+ptex-ptex0.o: ptex0.c
+@am__fastdepCC_TRUE@	$(CC) $(DEFS) $(DEFAULT_INCLUDES) $(INCLUDES) $(ptex_CPPFLAGS) $(CPPFLAGS) $(AM_CFLAGS) $(CFLAGS) -MT ptex-ptex0.o -MD -MP -MF $(DEPDIR)/ptex-ptex0.Tpo -c -o ptex-ptex0.o `test -f 'ptex0.c' || echo '$(srcdir)/'`ptex0.c
+@am__fastdepCC_TRUE@	$(am__mv) $(DEPDIR)/ptex-ptex0.Tpo $(DEPDIR)/ptex-ptex0.Po
+@AMDEP_TRUE@@am__fastdepCC_FALSE@	source='ptex0.c' object='ptex-ptex0.o' libtool=no @AMDEPBACKSLASH@
+@AMDEP_TRUE@@am__fastdepCC_FALSE@	DEPDIR=$(DEPDIR) $(CCDEPMODE) $(depcomp) @AMDEPBACKSLASH@
+@am__fastdepCC_FALSE@	$(CC) $(DEFS) $(DEFAULT_INCLUDES) $(INCLUDES) $(ptex_CPPFLAGS) $(CPPFLAGS) $(AM_CFLAGS) $(CFLAGS) -c -o ptex-ptex0.o `test -f 'ptex0.c' || echo '$(srcdir)/'`ptex0.c
+
+ptex-ptex0.obj: ptex0.c
+@am__fastdepCC_TRUE@	$(CC) $(DEFS) $(DEFAULT_INCLUDES) $(INCLUDES) $(ptex_CPPFLAGS) $(CPPFLAGS) $(AM_CFLAGS) $(CFLAGS) -MT ptex-ptex0.obj -MD -MP -MF $(DEPDIR)/ptex-ptex0.Tpo -c -o ptex-ptex0.obj `if test -f 'ptex0.c'; then $(CYGPATH_W) 'ptex0.c'; else $(CYGPATH_W) '$(srcdir)/ptex0.c'; fi`
+@am__fastdepCC_TRUE@	$(am__mv) $(DEPDIR)/ptex-ptex0.Tpo $(DEPDIR)/ptex-ptex0.Po
+@AMDEP_TRUE@@am__fastdepCC_FALSE@	source='ptex0.c' object='ptex-ptex0.obj' libtool=no @AMDEPBACKSLASH@
+@AMDEP_TRUE@@am__fastdepCC_FALSE@	DEPDIR=$(DEPDIR) $(CCDEPMODE) $(depcomp) @AMDEPBACKSLASH@
+@am__fastdepCC_FALSE@	$(CC) $(DEFS) $(DEFAULT_INCLUDES) $(INCLUDES) $(ptex_CPPFLAGS) $(CPPFLAGS) $(AM_CFLAGS) $(CFLAGS) -c -o ptex-ptex0.obj `if test -f 'ptex0.c'; then $(CYGPATH_W) 'ptex0.c'; else $(CYGPATH_W) '$(srcdir)/ptex0.c'; fi`
+
+ptex-ptex1.o: ptex1.c
+@am__fastdepCC_TRUE@	$(CC) $(DEFS) $(DEFAULT_INCLUDES) $(INCLUDES) $(ptex_CPPFLAGS) $(CPPFLAGS) $(AM_CFLAGS) $(CFLAGS) -MT ptex-ptex1.o -MD -MP -MF $(DEPDIR)/ptex-ptex1.Tpo -c -o ptex-ptex1.o `test -f 'ptex1.c' || echo '$(srcdir)/'`ptex1.c
+@am__fastdepCC_TRUE@	$(am__mv) $(DEPDIR)/ptex-ptex1.Tpo $(DEPDIR)/ptex-ptex1.Po
+@AMDEP_TRUE@@am__fastdepCC_FALSE@	source='ptex1.c' object='ptex-ptex1.o' libtool=no @AMDEPBACKSLASH@
+@AMDEP_TRUE@@am__fastdepCC_FALSE@	DEPDIR=$(DEPDIR) $(CCDEPMODE) $(depcomp) @AMDEPBACKSLASH@
+@am__fastdepCC_FALSE@	$(CC) $(DEFS) $(DEFAULT_INCLUDES) $(INCLUDES) $(ptex_CPPFLAGS) $(CPPFLAGS) $(AM_CFLAGS) $(CFLAGS) -c -o ptex-ptex1.o `test -f 'ptex1.c' || echo '$(srcdir)/'`ptex1.c
+
+ptex-ptex1.obj: ptex1.c
+@am__fastdepCC_TRUE@	$(CC) $(DEFS) $(DEFAULT_INCLUDES) $(INCLUDES) $(ptex_CPPFLAGS) $(CPPFLAGS) $(AM_CFLAGS) $(CFLAGS) -MT ptex-ptex1.obj -MD -MP -MF $(DEPDIR)/ptex-ptex1.Tpo -c -o ptex-ptex1.obj `if test -f 'ptex1.c'; then $(CYGPATH_W) 'ptex1.c'; else $(CYGPATH_W) '$(srcdir)/ptex1.c'; fi`
+@am__fastdepCC_TRUE@	$(am__mv) $(DEPDIR)/ptex-ptex1.Tpo $(DEPDIR)/ptex-ptex1.Po
+@AMDEP_TRUE@@am__fastdepCC_FALSE@	source='ptex1.c' object='ptex-ptex1.obj' libtool=no @AMDEPBACKSLASH@
+@AMDEP_TRUE@@am__fastdepCC_FALSE@	DEPDIR=$(DEPDIR) $(CCDEPMODE) $(depcomp) @AMDEPBACKSLASH@
+@am__fastdepCC_FALSE@	$(CC) $(DEFS) $(DEFAULT_INCLUDES) $(INCLUDES) $(ptex_CPPFLAGS) $(CPPFLAGS) $(AM_CFLAGS) $(CFLAGS) -c -o ptex-ptex1.obj `if test -f 'ptex1.c'; then $(CYGPATH_W) 'ptex1.c'; else $(CYGPATH_W) '$(srcdir)/ptex1.c'; fi`
+
+ptex-ptex2.o: ptex2.c
+@am__fastdepCC_TRUE@	$(CC) $(DEFS) $(DEFAULT_INCLUDES) $(INCLUDES) $(ptex_CPPFLAGS) $(CPPFLAGS) $(AM_CFLAGS) $(CFLAGS) -MT ptex-ptex2.o -MD -MP -MF $(DEPDIR)/ptex-ptex2.Tpo -c -o ptex-ptex2.o `test -f 'ptex2.c' || echo '$(srcdir)/'`ptex2.c
+@am__fastdepCC_TRUE@	$(am__mv) $(DEPDIR)/ptex-ptex2.Tpo $(DEPDIR)/ptex-ptex2.Po
+@AMDEP_TRUE@@am__fastdepCC_FALSE@	source='ptex2.c' object='ptex-ptex2.o' libtool=no @AMDEPBACKSLASH@
+@AMDEP_TRUE@@am__fastdepCC_FALSE@	DEPDIR=$(DEPDIR) $(CCDEPMODE) $(depcomp) @AMDEPBACKSLASH@
+@am__fastdepCC_FALSE@	$(CC) $(DEFS) $(DEFAULT_INCLUDES) $(INCLUDES) $(ptex_CPPFLAGS) $(CPPFLAGS) $(AM_CFLAGS) $(CFLAGS) -c -o ptex-ptex2.o `test -f 'ptex2.c' || echo '$(srcdir)/'`ptex2.c
+
+ptex-ptex2.obj: ptex2.c
+@am__fastdepCC_TRUE@	$(CC) $(DEFS) $(DEFAULT_INCLUDES) $(INCLUDES) $(ptex_CPPFLAGS) $(CPPFLAGS) $(AM_CFLAGS) $(CFLAGS) -MT ptex-ptex2.obj -MD -MP -MF $(DEPDIR)/ptex-ptex2.Tpo -c -o ptex-ptex2.obj `if test -f 'ptex2.c'; then $(CYGPATH_W) 'ptex2.c'; else $(CYGPATH_W) '$(srcdir)/ptex2.c'; fi`
+@am__fastdepCC_TRUE@	$(am__mv) $(DEPDIR)/ptex-ptex2.Tpo $(DEPDIR)/ptex-ptex2.Po
+@AMDEP_TRUE@@am__fastdepCC_FALSE@	source='ptex2.c' object='ptex-ptex2.obj' libtool=no @AMDEPBACKSLASH@
+@AMDEP_TRUE@@am__fastdepCC_FALSE@	DEPDIR=$(DEPDIR) $(CCDEPMODE) $(depcomp) @AMDEPBACKSLASH@
+@am__fastdepCC_FALSE@	$(CC) $(DEFS) $(DEFAULT_INCLUDES) $(INCLUDES) $(ptex_CPPFLAGS) $(CPPFLAGS) $(AM_CFLAGS) $(CFLAGS) -c -o ptex-ptex2.obj `if test -f 'ptex2.c'; then $(CYGPATH_W) 'ptex2.c'; else $(CYGPATH_W) '$(srcdir)/ptex2.c'; fi`
+
+ptex-ptex-pool.o: ptex-pool.c
+@am__fastdepCC_TRUE@	$(CC) $(DEFS) $(DEFAULT_INCLUDES) $(INCLUDES) $(ptex_CPPFLAGS) $(CPPFLAGS) $(AM_CFLAGS) $(CFLAGS) -MT ptex-ptex-pool.o -MD -MP -MF $(DEPDIR)/ptex-ptex-pool.Tpo -c -o ptex-ptex-pool.o `test -f 'ptex-pool.c' || echo '$(srcdir)/'`ptex-pool.c
+@am__fastdepCC_TRUE@	$(am__mv) $(DEPDIR)/ptex-ptex-pool.Tpo $(DEPDIR)/ptex-ptex-pool.Po
+@AMDEP_TRUE@@am__fastdepCC_FALSE@	source='ptex-pool.c' object='ptex-ptex-pool.o' libtool=no @AMDEPBACKSLASH@
+@AMDEP_TRUE@@am__fastdepCC_FALSE@	DEPDIR=$(DEPDIR) $(CCDEPMODE) $(depcomp) @AMDEPBACKSLASH@
+@am__fastdepCC_FALSE@	$(CC) $(DEFS) $(DEFAULT_INCLUDES) $(INCLUDES) $(ptex_CPPFLAGS) $(CPPFLAGS) $(AM_CFLAGS) $(CFLAGS) -c -o ptex-ptex-pool.o `test -f 'ptex-pool.c' || echo '$(srcdir)/'`ptex-pool.c
+
+ptex-ptex-pool.obj: ptex-pool.c
+@am__fastdepCC_TRUE@	$(CC) $(DEFS) $(DEFAULT_INCLUDES) $(INCLUDES) $(ptex_CPPFLAGS) $(CPPFLAGS) $(AM_CFLAGS) $(CFLAGS) -MT ptex-ptex-pool.obj -MD -MP -MF $(DEPDIR)/ptex-ptex-pool.Tpo -c -o ptex-ptex-pool.obj `if test -f 'ptex-pool.c'; then $(CYGPATH_W) 'ptex-pool.c'; else $(CYGPATH_W) '$(srcdir)/ptex-pool.c'; fi`
+@am__fastdepCC_TRUE@	$(am__mv) $(DEPDIR)/ptex-ptex-pool.Tpo $(DEPDIR)/ptex-ptex-pool.Po
+@AMDEP_TRUE@@am__fastdepCC_FALSE@	source='ptex-pool.c' object='ptex-ptex-pool.obj' libtool=no @AMDEPBACKSLASH@
+@AMDEP_TRUE@@am__fastdepCC_FALSE@	DEPDIR=$(DEPDIR) $(CCDEPMODE) $(depcomp) @AMDEPBACKSLASH@
+@am__fastdepCC_FALSE@	$(CC) $(DEFS) $(DEFAULT_INCLUDES) $(INCLUDES) $(ptex_CPPFLAGS) $(CPPFLAGS) $(AM_CFLAGS) $(CFLAGS) -c -o ptex-ptex-pool.obj `if test -f 'ptex-pool.c'; then $(CYGPATH_W) 'ptex-pool.c'; else $(CYGPATH_W) '$(srcdir)/ptex-pool.c'; fi`
+
+ptex-ptexextra.o: ptexextra.c
+@am__fastdepCC_TRUE@	$(CC) $(DEFS) $(DEFAULT_INCLUDES) $(INCLUDES) $(ptex_CPPFLAGS) $(CPPFLAGS) $(AM_CFLAGS) $(CFLAGS) -MT ptex-ptexextra.o -MD -MP -MF $(DEPDIR)/ptex-ptexextra.Tpo -c -o ptex-ptexextra.o `test -f 'ptexextra.c' || echo '$(srcdir)/'`ptexextra.c
+@am__fastdepCC_TRUE@	$(am__mv) $(DEPDIR)/ptex-ptexextra.Tpo $(DEPDIR)/ptex-ptexextra.Po
+@AMDEP_TRUE@@am__fastdepCC_FALSE@	source='ptexextra.c' object='ptex-ptexextra.o' libtool=no @AMDEPBACKSLASH@
+@AMDEP_TRUE@@am__fastdepCC_FALSE@	DEPDIR=$(DEPDIR) $(CCDEPMODE) $(depcomp) @AMDEPBACKSLASH@
+@am__fastdepCC_FALSE@	$(CC) $(DEFS) $(DEFAULT_INCLUDES) $(INCLUDES) $(ptex_CPPFLAGS) $(CPPFLAGS) $(AM_CFLAGS) $(CFLAGS) -c -o ptex-ptexextra.o `test -f 'ptexextra.c' || echo '$(srcdir)/'`ptexextra.c
+
+ptex-ptexextra.obj: ptexextra.c
+@am__fastdepCC_TRUE@	$(CC) $(DEFS) $(DEFAULT_INCLUDES) $(INCLUDES) $(ptex_CPPFLAGS) $(CPPFLAGS) $(AM_CFLAGS) $(CFLAGS) -MT ptex-ptexextra.obj -MD -MP -MF $(DEPDIR)/ptex-ptexextra.Tpo -c -o ptex-ptexextra.obj `if test -f 'ptexextra.c'; then $(CYGPATH_W) 'ptexextra.c'; else $(CYGPATH_W) '$(srcdir)/ptexextra.c'; fi`
+@am__fastdepCC_TRUE@	$(am__mv) $(DEPDIR)/ptex-ptexextra.Tpo $(DEPDIR)/ptex-ptexextra.Po
+@AMDEP_TRUE@@am__fastdepCC_FALSE@	source='ptexextra.c' object='ptex-ptexextra.obj' libtool=no @AMDEPBACKSLASH@
+@AMDEP_TRUE@@am__fastdepCC_FALSE@	DEPDIR=$(DEPDIR) $(CCDEPMODE) $(depcomp) @AMDEPBACKSLASH@
+@am__fastdepCC_FALSE@	$(CC) $(DEFS) $(DEFAULT_INCLUDES) $(INCLUDES) $(ptex_CPPFLAGS) $(CPPFLAGS) $(AM_CFLAGS) $(CFLAGS) -c -o ptex-ptexextra.obj `if test -f 'ptexextra.c'; then $(CYGPATH_W) 'ptexextra.c'; else $(CYGPATH_W) '$(srcdir)/ptexextra.c'; fi`
+
+ptex-kanji.o: ptexdir/kanji.c
+@am__fastdepCC_TRUE@	$(CC) $(DEFS) $(DEFAULT_INCLUDES) $(INCLUDES) $(ptex_CPPFLAGS) $(CPPFLAGS) $(AM_CFLAGS) $(CFLAGS) -MT ptex-kanji.o -MD -MP -MF $(DEPDIR)/ptex-kanji.Tpo -c -o ptex-kanji.o `test -f 'ptexdir/kanji.c' || echo '$(srcdir)/'`ptexdir/kanji.c
+@am__fastdepCC_TRUE@	$(am__mv) $(DEPDIR)/ptex-kanji.Tpo $(DEPDIR)/ptex-kanji.Po
+@AMDEP_TRUE@@am__fastdepCC_FALSE@	source='ptexdir/kanji.c' object='ptex-kanji.o' libtool=no @AMDEPBACKSLASH@
+@AMDEP_TRUE@@am__fastdepCC_FALSE@	DEPDIR=$(DEPDIR) $(CCDEPMODE) $(depcomp) @AMDEPBACKSLASH@
+@am__fastdepCC_FALSE@	$(CC) $(DEFS) $(DEFAULT_INCLUDES) $(INCLUDES) $(ptex_CPPFLAGS) $(CPPFLAGS) $(AM_CFLAGS) $(CFLAGS) -c -o ptex-kanji.o `test -f 'ptexdir/kanji.c' || echo '$(srcdir)/'`ptexdir/kanji.c
+
+ptex-kanji.obj: ptexdir/kanji.c
+@am__fastdepCC_TRUE@	$(CC) $(DEFS) $(DEFAULT_INCLUDES) $(INCLUDES) $(ptex_CPPFLAGS) $(CPPFLAGS) $(AM_CFLAGS) $(CFLAGS) -MT ptex-kanji.obj -MD -MP -MF $(DEPDIR)/ptex-kanji.Tpo -c -o ptex-kanji.obj `if test -f 'ptexdir/kanji.c'; then $(CYGPATH_W) 'ptexdir/kanji.c'; else $(CYGPATH_W) '$(srcdir)/ptexdir/kanji.c'; fi`
+@am__fastdepCC_TRUE@	$(am__mv) $(DEPDIR)/ptex-kanji.Tpo $(DEPDIR)/ptex-kanji.Po
+@AMDEP_TRUE@@am__fastdepCC_FALSE@	source='ptexdir/kanji.c' object='ptex-kanji.obj' libtool=no @AMDEPBACKSLASH@
+@AMDEP_TRUE@@am__fastdepCC_FALSE@	DEPDIR=$(DEPDIR) $(CCDEPMODE) $(depcomp) @AMDEPBACKSLASH@
+@am__fastdepCC_FALSE@	$(CC) $(DEFS) $(DEFAULT_INCLUDES) $(INCLUDES) $(ptex_CPPFLAGS) $(CPPFLAGS) $(AM_CFLAGS) $(CFLAGS) -c -o ptex-kanji.obj `if test -f 'ptexdir/kanji.c'; then $(CYGPATH_W) 'ptexdir/kanji.c'; else $(CYGPATH_W) '$(srcdir)/ptexdir/kanji.c'; fi`
+
 synctex-synctex_main.o: synctexdir/synctex_main.c
 @am__fastdepCC_TRUE@	$(CC) $(DEFS) $(DEFAULT_INCLUDES) $(INCLUDES) $(synctex_CPPFLAGS) $(CPPFLAGS) $(AM_CFLAGS) $(CFLAGS) -MT synctex-synctex_main.o -MD -MP -MF $(DEPDIR)/synctex-synctex_main.Tpo -c -o synctex-synctex_main.o `test -f 'synctexdir/synctex_main.c' || echo '$(srcdir)/'`synctexdir/synctex_main.c
 @am__fastdepCC_TRUE@	$(am__mv) $(DEPDIR)/synctex-synctex_main.Tpo $(DEPDIR)/synctex-synctex_main.Po
@@ -8237,6 +8477,99 @@
 	rm -f etrip.fot etrip.log etrip.dvi etrip.out etrip.typ
 	rm -f tripos.tex 8terminal.tex
 	rm -rf tfm
+# Rebuild $(pproglib)
+$(pproglib): $(KPATHSEA_DEPEND) ${srcdir}/ptexdir/lib/*.c
+	cd ptexdir/lib && $(MAKE) $(AM_MAKEFLAGS)
+
+$(ptex_c_h): ptex-web2c
+ptex-web2c: ptex.p $(web2c_texmf)
+	$(web2c) ptex
+#	: $(synctex_convert_ptex)
+	echo timestamp >$@
+	touch $(ptex_c_h)
+
+ptex-pool.c: ptex.pool $(makecpool_stamp) tmf-pool.h
+	$(makecpool) ptex.pool $(srcdir)/tmf-pool.h >$@ || rm -f $@
+
+ptexextra.c: ptexdir/ptexextra.h lib/texmfmp.c ptexd.h
+	sed s/TEX-OR-MF-OR-MP/ptex/ $(srcdir)/lib/texmfmp.c >$@
+
+ptexdir/ptexextra.h: ptexdir/ptexextra.in ptexdir/ptex.version
+	sed s/PTEX-VERSION/`cat ptexdir/ptex.version`/ \
+	  $(srcdir)/ptexdir/ptexextra.in >$@
+
+# Tangling pTeX
+ptex.p ptex.pool: ptex-tangle
+ptex-tangle: tangle$(EXEEXT) ptex.web ptex.ch
+	$(tangle) ptex ptex
+	echo timestamp >$@
+	touch ptex.p ptex.pool
+
+# Extract ptex version
+ptexdir/ptex.version: ptexdir/ptex-base.ch
+	$(mkdir_p) ptexdir/lib
+	grep "^@d TeX_banner=='This is pTeX" $(srcdir)/ptexdir/ptex-base.ch \
+	  | sed "s/^.*-//;s/'.*$$//" >ptexdir/ptex.version
+
+# Generate ptex.web
+ptex.web: tie$(EXEEXT) $(ptex_web_srcs)
+	$(tie) -m ptex.web $(ptex_web_srcs)
+
+# Generate ptex.ch
+ptex.ch: tie$(EXEEXT) ptex.web $(ptex_ch_srcs)
+	$(tie) -c ptex.ch ptex.web $(ptex_ch_srcs)
+pbibtex.c pbibtex.h: pbibtex-web2c
+pbibtex.o: pbibtex.c $(srcdir)/ptexdir/kanji.h $(srcdir)/ptexdir/ptexhelp.h
+pbibtex-web2c: $(web2c_depend) web2c/cvtbib.sed pbibtex.p
+	$(web2c) pbibtex
+	echo timestamp >$@
+	touch pbibtex.c pbibtex.h
+pbibtex.p: tangle$(EXEEXT) pbibtex.web $(srcdir)/ptexdir/pbibtex.ch
+	$(tangle) pbibtex.web $(srcdir)/ptexdir/pbibtex.ch
+pbibtex.web: $(srcdir)/bibtex.web
+	cat  $(srcdir)/bibtex.web > $@
+pdvitype.c pdvitype.h: pdvitype-web2c
+pdvitype.o: pdvitype.c $(srcdir)/ptexdir/kanji.h $(srcdir)/ptexdir/ptexhelp.h
+pdvitype-web2c: $(web2c_depend) pdvitype.p
+	$(web2c) pdvitype
+	echo timestamp >$@
+	touch pdvitype.c pdvitype.h
+pdvitype.p: tangle$(EXEEXT) pdvitype.web $(srcdir)/ptexdir/pdvitype.ch
+	$(tangle) pdvitype $(srcdir)/ptexdir/pdvitype
+pdvitype.web: $(srcdir)/dvitype.web
+	cat   $(srcdir)/dvitype.web > $@
+ptftopl.c ptftopl.h: ptftopl-web2c
+ptftopl.o: ptftopl.c $(srcdir)/ptexdir/kanji.h $(srcdir)/ptexdir/ptexhelp.h
+ptftopl-web2c: $(web2c_depend) ptftopl.p
+	$(web2c) ptftopl
+	echo timestamp >$@
+	touch ptftopl.c ptftopl.h
+ptftopl.p: tangle$(EXEEXT) ptftopl.web $(srcdir)/ptexdir/ptftopl.ch
+	$(tangle) ptftopl.web $(srcdir)/ptexdir/ptftopl.ch
+ptftopl.web: tie$(EXEEXT)     $(srcdir)/tftopl.web $(srcdir)/tftopl.ch
+	$(tie) -m ptftopl.web $(srcdir)/tftopl.web $(srcdir)/tftopl.ch
+ppltotf.c ppltotf.h: ppltotf-web2c
+pppltotf.o: pppltotf.c $(srcdir)/ptexdir/kanji.h $(srcdir)/ptexdir/ptexhelp.h
+ppltotf-web2c: $(web2c_depend) ppltotf.p
+	$(web2c) ppltotf
+	echo timestamp >$@
+	touch ppltotf.c ppltotf.h
+ppltotf.p: tangle$(EXEEXT) ppltotf.web $(srcdir)/ptexdir/ppltotf.ch
+	$(tangle) ppltotf.web $(srcdir)/ptexdir/ppltotf
+ppltotf.web: tie$(EXEEXT)     $(srcdir)/pltotf.web $(srcdir)/pltotf.ch
+	$(tie) -m ppltotf.web $(srcdir)/pltotf.web $(srcdir)/pltotf.ch
+
+.PHONY: ptrip-clean
+clean-local:: ptrip-clean
+ptrip-clean:
+	rm -f trip.tfm trip.pl trip.tex trip.fmt ctripin.fot ctripin.log
+	rm -f ctrip.fot ctrip.log trip.dvi ctrip.typ
+	rm -f xtripin.fot xtripin.log
+	rm -f xtrip.fot xtrip.log xtrip.typ
+	rm -f ptrip.tfm ptrip.pl ptrip.tex ptrip.fmt ptripin.fot ptripin.log
+	rm -f ptrip.fot ptrip.log ptrip.dvi ptrip.out ptrip.typ
+	rm -f tripos.tex 8terminal.tex
+	rm -rf tfm
 $(pdftex_c_h): pdftex-web2c
 pdftex-web2c: pdftex.p $(web2c_texmf) pdftexdir/pdftex.defines
 	$(web2c) pdftex
Index: texk/web2c/configure.ac
===================================================================
--- texlive-20091011-source.orig/texk/web2c/configure.ac
+++ texlive-20091011-source/texk/web2c/configure.ac
@@ -246,6 +246,7 @@
 AC_TYPE_SIGNAL
 
 KPSE_KPATHSEA_FLAGS
+KPSE_PTEXENC_FLAGS
 KPSE_ZLIB_FLAGS
 KPSE_LIBPNG_FLAGS
 KPSE_XPDF_FLAGS
@@ -358,6 +359,7 @@
 AC_CONFIG_SUBDIRS([web2c])
 
 AC_CONFIG_FILES([Makefile doc/Makefile lib/Makefile man/Makefile
+                 ptexdir/lib/Makefile
                  omegafonts/Makefile otps/Makefile window/Makefile])
 
 dnl The subdirectory web2c must be configured for the build system.
Index: texk/web2c/doc/Makefile.in
===================================================================
--- texlive-20091011-source.orig/texk/web2c/doc/Makefile.in
+++ texlive-20091011-source/texk/web2c/doc/Makefile.in
@@ -50,6 +50,7 @@
 	$(top_srcdir)/../../m4/kpse-libpng-flags.m4 \
 	$(top_srcdir)/../../m4/kpse-macos-framework.m4 \
 	$(top_srcdir)/../../m4/kpse-obsdcompat-flags.m4 \
+	$(top_srcdir)/../../m4/kpse-ptexenc-flags.m4 \
 	$(top_srcdir)/../../m4/kpse-socket-libs.m4 \
 	$(top_srcdir)/../../m4/kpse-teckit-flags.m4 \
 	$(top_srcdir)/../../m4/kpse-warnings.m4 \
@@ -198,6 +199,9 @@
 PACKAGE_VERSION = @PACKAGE_VERSION@
 PATH_SEPARATOR = @PATH_SEPARATOR@
 PKG_CONFIG = @PKG_CONFIG@
+PTEXENC_DEPEND = @PTEXENC_DEPEND@
+PTEXENC_INCLUDES = @PTEXENC_INCLUDES@
+PTEXENC_LIBS = @PTEXENC_LIBS@
 RANLIB = @RANLIB@
 SED = @SED@
 SET_MAKE = @SET_MAKE@
Index: texk/web2c/window/Makefile.in
===================================================================
--- texlive-20091011-source.orig/texk/web2c/window/Makefile.in
+++ texlive-20091011-source/texk/web2c/window/Makefile.in
@@ -52,6 +52,7 @@
 	$(top_srcdir)/../../m4/kpse-libpng-flags.m4 \
 	$(top_srcdir)/../../m4/kpse-macos-framework.m4 \
 	$(top_srcdir)/../../m4/kpse-obsdcompat-flags.m4 \
+	$(top_srcdir)/../../m4/kpse-ptexenc-flags.m4 \
 	$(top_srcdir)/../../m4/kpse-socket-libs.m4 \
 	$(top_srcdir)/../../m4/kpse-teckit-flags.m4 \
 	$(top_srcdir)/../../m4/kpse-warnings.m4 \
@@ -194,6 +195,9 @@
 PACKAGE_VERSION = @PACKAGE_VERSION@
 PATH_SEPARATOR = @PATH_SEPARATOR@
 PKG_CONFIG = @PKG_CONFIG@
+PTEXENC_DEPEND = @PTEXENC_DEPEND@
+PTEXENC_INCLUDES = @PTEXENC_INCLUDES@
+PTEXENC_LIBS = @PTEXENC_LIBS@
 RANLIB = @RANLIB@
 SED = @SED@
 SET_MAKE = @SET_MAKE@
Index: texk/web2c/man/Makefile.in
===================================================================
--- texlive-20091011-source.orig/texk/web2c/man/Makefile.in
+++ texlive-20091011-source/texk/web2c/man/Makefile.in
@@ -61,6 +61,7 @@
 	$(top_srcdir)/../../m4/kpse-libpng-flags.m4 \
 	$(top_srcdir)/../../m4/kpse-macos-framework.m4 \
 	$(top_srcdir)/../../m4/kpse-obsdcompat-flags.m4 \
+	$(top_srcdir)/../../m4/kpse-ptexenc-flags.m4 \
 	$(top_srcdir)/../../m4/kpse-socket-libs.m4 \
 	$(top_srcdir)/../../m4/kpse-teckit-flags.m4 \
 	$(top_srcdir)/../../m4/kpse-warnings.m4 \
@@ -199,6 +200,9 @@
 PACKAGE_VERSION = @PACKAGE_VERSION@
 PATH_SEPARATOR = @PATH_SEPARATOR@
 PKG_CONFIG = @PKG_CONFIG@
+PTEXENC_DEPEND = @PTEXENC_DEPEND@
+PTEXENC_INCLUDES = @PTEXENC_INCLUDES@
+PTEXENC_LIBS = @PTEXENC_LIBS@
 RANLIB = @RANLIB@
 SED = @SED@
 SET_MAKE = @SET_MAKE@
Index: texk/web2c/fmtutil.in
===================================================================
--- texlive-20091011-source.orig/texk/web2c/fmtutil.in
+++ texlive-20091011-source/texk/web2c/fmtutil.in
@@ -73,6 +73,10 @@
 # if you want babel support in pdfamstex:
 #! pdfamstex	pdftex			-	-translate-file=cp227.tcx *pdfamstex.ini
 
+# Japanese pTeX:
+@PTEX@ptex		ptex	-		--kanji=default ptex.ini
+@PTEX@platex		ptex	language.dat	--kanji=default platex.ini
+
 # Context formats:
 #! cont-cz	pdftex		cont-usr.tex	-8bit *cont-cz.ini
 #! cont-cz	xetex		cont-usr.tex	-8bit *cont-cz.ini
Index: texk/web2c/configure
===================================================================
--- texlive-20091011-source.orig/texk/web2c/configure
+++ texlive-20091011-source/texk/web2c/configure
@@ -832,6 +832,10 @@
 ZLIB_DEPEND
 ZLIB_LIBS
 ZLIB_INCLUDES
+PTEXENC_RULE
+PTEXENC_DEPEND
+PTEXENC_LIBS
+PTEXENC_INCLUDES
 KPATHSEA_RULE
 KPATHSEA_DEPEND
 KPATHSEA_LIBS
@@ -880,6 +884,10 @@
 ALEPH_SYNCTEX_TRUE
 ALEPH_FALSE
 ALEPH_TRUE
+PTEX_SYNCTEX_FALSE
+PTEX_SYNCTEX_TRUE
+PTEX_FALSE
+PTEX_TRUE
 ETEX_SYNCTEX_FALSE
 ETEX_SYNCTEX_TRUE
 ETEX_FALSE
@@ -1044,6 +1052,7 @@
 enable_omfonts
 enable_tex
 enable_etex
+enable_ptex
 enable_aleph
 enable_pdftex
 enable_luatex
@@ -1754,6 +1763,7 @@
                           versions)
   --disable-tex           do not compile and install TeX
   --enable-etex           compile and install e-TeX
+  --disable-ptex          do not compile and install pTeX
   --disable-aleph         do not compile and install Aleph
   --disable-pdftex        do not compile and install pdfTeX
   --disable-luatex        do not compile and install luaTeX
@@ -4571,13 +4581,13 @@
 else
   lt_cv_nm_interface="BSD nm"
   echo "int some_variable = 0;" > conftest.$ac_ext
-  (eval echo "\"\$as_me:4574: $ac_compile\"" >&5)
+  (eval echo "\"\$as_me:4584: $ac_compile\"" >&5)
   (eval "$ac_compile" 2>conftest.err)
   cat conftest.err >&5
-  (eval echo "\"\$as_me:4577: $NM \\\"conftest.$ac_objext\\\"\"" >&5)
+  (eval echo "\"\$as_me:4587: $NM \\\"conftest.$ac_objext\\\"\"" >&5)
   (eval "$NM \"conftest.$ac_objext\"" 2>conftest.err > conftest.out)
   cat conftest.err >&5
-  (eval echo "\"\$as_me:4580: output\"" >&5)
+  (eval echo "\"\$as_me:4590: output\"" >&5)
   cat conftest.out >&5
   if $GREP 'External.*some_variable' conftest.out > /dev/null; then
     lt_cv_nm_interface="MS dumpbin"
@@ -5783,7 +5793,7 @@
   ;;
 *-*-irix6*)
   # Find out which ABI we are using.
-  echo '#line 5786 "configure"' > conftest.$ac_ext
+  echo '#line 5796 "configure"' > conftest.$ac_ext
   if { (eval echo "$as_me:$LINENO: \"$ac_compile\"") >&5
   (eval $ac_compile) 2>&5
   ac_status=$?
@@ -7744,11 +7754,11 @@
    -e 's:.*FLAGS}\{0,1\} :&$lt_compiler_flag :; t' \
    -e 's: [^ ]*conftest\.: $lt_compiler_flag&:; t' \
    -e 's:$: $lt_compiler_flag:'`
-   (eval echo "\"\$as_me:7747: $lt_compile\"" >&5)
+   (eval echo "\"\$as_me:7757: $lt_compile\"" >&5)
    (eval "$lt_compile" 2>conftest.err)
    ac_status=$?
    cat conftest.err >&5
-   echo "$as_me:7751: \$? = $ac_status" >&5
+   echo "$as_me:7761: \$? = $ac_status" >&5
    if (exit $ac_status) && test -s "$ac_outfile"; then
      # The compiler can only warn and ignore the option if not recognized
      # So say no if there are warnings other than the usual output.
@@ -8083,11 +8093,11 @@
    -e 's:.*FLAGS}\{0,1\} :&$lt_compiler_flag :; t' \
    -e 's: [^ ]*conftest\.: $lt_compiler_flag&:; t' \
    -e 's:$: $lt_compiler_flag:'`
-   (eval echo "\"\$as_me:8086: $lt_compile\"" >&5)
+   (eval echo "\"\$as_me:8096: $lt_compile\"" >&5)
    (eval "$lt_compile" 2>conftest.err)
    ac_status=$?
    cat conftest.err >&5
-   echo "$as_me:8090: \$? = $ac_status" >&5
+   echo "$as_me:8100: \$? = $ac_status" >&5
    if (exit $ac_status) && test -s "$ac_outfile"; then
      # The compiler can only warn and ignore the option if not recognized
      # So say no if there are warnings other than the usual output.
@@ -8188,11 +8198,11 @@
    -e 's:.*FLAGS}\{0,1\} :&$lt_compiler_flag :; t' \
    -e 's: [^ ]*conftest\.: $lt_compiler_flag&:; t' \
    -e 's:$: $lt_compiler_flag:'`
-   (eval echo "\"\$as_me:8191: $lt_compile\"" >&5)
+   (eval echo "\"\$as_me:8201: $lt_compile\"" >&5)
    (eval "$lt_compile" 2>out/conftest.err)
    ac_status=$?
    cat out/conftest.err >&5
-   echo "$as_me:8195: \$? = $ac_status" >&5
+   echo "$as_me:8205: \$? = $ac_status" >&5
    if (exit $ac_status) && test -s out/conftest2.$ac_objext
    then
      # The compiler can only warn and ignore the option if not recognized
@@ -8243,11 +8253,11 @@
    -e 's:.*FLAGS}\{0,1\} :&$lt_compiler_flag :; t' \
    -e 's: [^ ]*conftest\.: $lt_compiler_flag&:; t' \
    -e 's:$: $lt_compiler_flag:'`
-   (eval echo "\"\$as_me:8246: $lt_compile\"" >&5)
+   (eval echo "\"\$as_me:8256: $lt_compile\"" >&5)
    (eval "$lt_compile" 2>out/conftest.err)
    ac_status=$?
    cat out/conftest.err >&5
-   echo "$as_me:8250: \$? = $ac_status" >&5
+   echo "$as_me:8260: \$? = $ac_status" >&5
    if (exit $ac_status) && test -s out/conftest2.$ac_objext
    then
      # The compiler can only warn and ignore the option if not recognized
@@ -11043,7 +11053,7 @@
   lt_dlunknown=0; lt_dlno_uscore=1; lt_dlneed_uscore=2
   lt_status=$lt_dlunknown
   cat > conftest.$ac_ext <<_LT_EOF
-#line 11046 "configure"
+#line 11056 "configure"
 #include "confdefs.h"
 
 #if HAVE_DLFCN_H
@@ -11139,7 +11149,7 @@
   lt_dlunknown=0; lt_dlno_uscore=1; lt_dlneed_uscore=2
   lt_status=$lt_dlunknown
   cat > conftest.$ac_ext <<_LT_EOF
-#line 11142 "configure"
+#line 11152 "configure"
 #include "confdefs.h"
 
 #if HAVE_DLFCN_H
@@ -16259,11 +16269,11 @@
    -e 's:.*FLAGS}\{0,1\} :&$lt_compiler_flag :; t' \
    -e 's: [^ ]*conftest\.: $lt_compiler_flag&:; t' \
    -e 's:$: $lt_compiler_flag:'`
-   (eval echo "\"\$as_me:16262: $lt_compile\"" >&5)
+   (eval echo "\"\$as_me:16272: $lt_compile\"" >&5)
    (eval "$lt_compile" 2>conftest.err)
    ac_status=$?
    cat conftest.err >&5
-   echo "$as_me:16266: \$? = $ac_status" >&5
+   echo "$as_me:16276: \$? = $ac_status" >&5
    if (exit $ac_status) && test -s "$ac_outfile"; then
      # The compiler can only warn and ignore the option if not recognized
      # So say no if there are warnings other than the usual output.
@@ -16358,11 +16368,11 @@
    -e 's:.*FLAGS}\{0,1\} :&$lt_compiler_flag :; t' \
    -e 's: [^ ]*conftest\.: $lt_compiler_flag&:; t' \
    -e 's:$: $lt_compiler_flag:'`
-   (eval echo "\"\$as_me:16361: $lt_compile\"" >&5)
+   (eval echo "\"\$as_me:16371: $lt_compile\"" >&5)
    (eval "$lt_compile" 2>out/conftest.err)
    ac_status=$?
    cat out/conftest.err >&5
-   echo "$as_me:16365: \$? = $ac_status" >&5
+   echo "$as_me:16375: \$? = $ac_status" >&5
    if (exit $ac_status) && test -s out/conftest2.$ac_objext
    then
      # The compiler can only warn and ignore the option if not recognized
@@ -16410,11 +16420,11 @@
    -e 's:.*FLAGS}\{0,1\} :&$lt_compiler_flag :; t' \
    -e 's: [^ ]*conftest\.: $lt_compiler_flag&:; t' \
    -e 's:$: $lt_compiler_flag:'`
-   (eval echo "\"\$as_me:16413: $lt_compile\"" >&5)
+   (eval echo "\"\$as_me:16423: $lt_compile\"" >&5)
    (eval "$lt_compile" 2>out/conftest.err)
    ac_status=$?
    cat out/conftest.err >&5
-   echo "$as_me:16417: \$? = $ac_status" >&5
+   echo "$as_me:16427: \$? = $ac_status" >&5
    if (exit $ac_status) && test -s out/conftest2.$ac_objext
    then
      # The compiler can only warn and ignore the option if not recognized
@@ -17704,6 +17714,18 @@
   yes|no) : ;;
   *) enable_etex=no ;;
 esac
+# Check whether --enable-ptex was given.
+if test "${enable_ptex+set}" = set; then
+  enableval=$enable_ptex;
+fi
+case $enable_ptex in
+  yes|no) : ;;
+  *) enable_ptex=yes ;;
+esac
+
+test "x$enable_web2c:$enable_ptex" = xyes:yes && {
+  need_ptexenc=yes
+}
 # Check whether --enable-aleph was given.
 if test "${enable_aleph+set}" = set; then
   enableval=$enable_aleph;
@@ -18938,6 +18960,20 @@
   ETEX_SYNCTEX_TRUE='#'
   ETEX_SYNCTEX_FALSE=
 fi
+ if test "x$enable_ptex" = xyes; then
+  PTEX_TRUE=
+  PTEX_FALSE='#'
+else
+  PTEX_TRUE='#'
+  PTEX_FALSE=
+fi
+ if false; then
+  PTEX_SYNCTEX_TRUE=
+  PTEX_SYNCTEX_FALSE='#'
+else
+  PTEX_SYNCTEX_TRUE='#'
+  PTEX_SYNCTEX_FALSE=
+fi
  if test "x$enable_aleph" = xyes; then
   ALEPH_TRUE=
   ALEPH_FALSE='#'
@@ -24487,6 +24523,21 @@
 	cd ${top_builddir}/../kpathsea && $(MAKE) $(AM_MAKEFLAGS)'
 fi
 
+## _KPSE_LIB_FLAGS: Setup ptexenc (-lptexenc) flags
+  PTEXENC_INCLUDES=`echo '-IBLD/texk -ISRC/texk' | sed \
+    -e "s,SRC/,$kpse_SRC/,g" \
+    -e "s,BLD/,$kpse_BLD/,g"`
+  PTEXENC_LIBS=`echo 'BLD/texk/ptexenc/libptexenc.la' | sed \
+    -e "s,BLD/,$kpse_BLD/,g"`
+
+  PTEXENC_DEPEND=`echo 'BLD/texk/ptexenc/libptexenc.la' | sed \
+    -e 's,BLD/,${top_builddir}/../../,g'`
+   PTEXENC_RULE='# Rebuild libptexenc
+$(PTEXENC_DEPEND): ${top_srcdir}/../ptexenc/*.[ch] ${top_builddir}/../ptexenc/ptexenc.h
+	cd ${top_builddir}/../../libs/ptexenc && $(MAKE) $(AM_MAKEFLAGS)
+${top_builddir}/../ptexenc/ptexenc.h:
+	cd ${top_builddir}/../../libs/ptexenc && $(MAKE) $(AM_MAKEFLAGS)'
+
 ## _KPSE_LIB_FLAGS: Setup zlib (-lz) flags
 
 # Check whether --with-system-zlib was given.
@@ -25279,7 +25330,7 @@
 subdirs="$subdirs web2c"
 
 
-ac_config_files="$ac_config_files Makefile doc/Makefile lib/Makefile man/Makefile omegafonts/Makefile otps/Makefile window/Makefile"
+ac_config_files="$ac_config_files Makefile doc/Makefile lib/Makefile man/Makefile ptexdir/lib/Makefile omegafonts/Makefile otps/Makefile window/Makefile"
 
 
 
@@ -25480,6 +25531,20 @@
 Usually this means the macro was only invoked conditionally." >&2;}
    { (exit 1); exit 1; }; }
 fi
+if test -z "${PTEX_TRUE}" && test -z "${PTEX_FALSE}"; then
+  { { $as_echo "$as_me:$LINENO: error: conditional \"PTEX\" was never defined.
+Usually this means the macro was only invoked conditionally." >&5
+$as_echo "$as_me: error: conditional \"PTEX\" was never defined.
+Usually this means the macro was only invoked conditionally." >&2;}
+   { (exit 1); exit 1; }; }
+fi
+if test -z "${PTEX_SYNCTEX_TRUE}" && test -z "${PTEX_SYNCTEX_FALSE}"; then
+  { { $as_echo "$as_me:$LINENO: error: conditional \"PTEX_SYNCTEX\" was never defined.
+Usually this means the macro was only invoked conditionally." >&5
+$as_echo "$as_me: error: conditional \"PTEX_SYNCTEX\" was never defined.
+Usually this means the macro was only invoked conditionally." >&2;}
+   { (exit 1); exit 1; }; }
+fi
 if test -z "${ALEPH_TRUE}" && test -z "${ALEPH_FALSE}"; then
   { { $as_echo "$as_me:$LINENO: error: conditional \"ALEPH\" was never defined.
 Usually this means the macro was only invoked conditionally." >&5
@@ -26456,6 +26521,7 @@
     "doc/Makefile") CONFIG_FILES="$CONFIG_FILES doc/Makefile" ;;
     "lib/Makefile") CONFIG_FILES="$CONFIG_FILES lib/Makefile" ;;
     "man/Makefile") CONFIG_FILES="$CONFIG_FILES man/Makefile" ;;
+    "ptexdir/lib/Makefile") CONFIG_FILES="$CONFIG_FILES ptexdir/lib/Makefile" ;;
     "omegafonts/Makefile") CONFIG_FILES="$CONFIG_FILES omegafonts/Makefile" ;;
     "otps/Makefile") CONFIG_FILES="$CONFIG_FILES otps/Makefile" ;;
     "window/Makefile") CONFIG_FILES="$CONFIG_FILES window/Makefile" ;;
Index: texk/web2c/lib/Makefile.in
===================================================================
--- texlive-20091011-source.orig/texk/web2c/lib/Makefile.in
+++ texlive-20091011-source/texk/web2c/lib/Makefile.in
@@ -51,6 +51,7 @@
 	$(top_srcdir)/../../m4/kpse-libpng-flags.m4 \
 	$(top_srcdir)/../../m4/kpse-macos-framework.m4 \
 	$(top_srcdir)/../../m4/kpse-obsdcompat-flags.m4 \
+	$(top_srcdir)/../../m4/kpse-ptexenc-flags.m4 \
 	$(top_srcdir)/../../m4/kpse-socket-libs.m4 \
 	$(top_srcdir)/../../m4/kpse-teckit-flags.m4 \
 	$(top_srcdir)/../../m4/kpse-warnings.m4 \
@@ -189,6 +190,9 @@
 PACKAGE_VERSION = @PACKAGE_VERSION@
 PATH_SEPARATOR = @PATH_SEPARATOR@
 PKG_CONFIG = @PKG_CONFIG@
+PTEXENC_DEPEND = @PTEXENC_DEPEND@
+PTEXENC_INCLUDES = @PTEXENC_INCLUDES@
+PTEXENC_LIBS = @PTEXENC_LIBS@
 RANLIB = @RANLIB@
 SED = @SED@
 SET_MAKE = @SET_MAKE@
Index: texk/web2c/lib/texmfmp.c
===================================================================
--- texlive-20091011-source.orig/texk/web2c/lib/texmfmp.c
+++ texlive-20091011-source/texk/web2c/lib/texmfmp.c
@@ -50,6 +50,8 @@
 #include <luatexdir/luatexextra.h>
 #elif defined (Aleph)
 #include <alephdir/alephextra.h>
+#elif defined (pTeX)
+#include <ptexdir/ptexextra.h>
 #else
 #define BANNER "This is TeX, Version 3.1415926"
 #define COPYRIGHT_HOLDER "D.E. Knuth"
@@ -591,6 +593,9 @@
 
   /* Must be initialized before options are parsed.  */
   interactionoption = 4;
+#ifdef pTeX
+  set_enc_string (NULL, "default");
+#endif /* pTeX */
 
   /* Have things to record as we go along.  */
   kpse_record_input = recorder_record_input;
@@ -697,7 +702,7 @@
     if (mltexp) {
       fprintf(stderr, "-mltex only works with -ini\n");
     }
-#if !defined(XeTeX)
+#if !defined(XeTeX) && !defined(pTeX)
     if (enctexp) {
       fprintf(stderr, "-enc only works with -ini\n");
     }
@@ -1311,9 +1316,9 @@
 #endif /* IPC */
 #if !defined(Aleph) && !defined(luaTeX)
       { "mltex",                     0, &mltexp, 1 },
-#if !defined(XeTeX)
+#if !defined(XeTeX) && !defined(pTeX)
       { "enc",                       0, &enctexp, 1 },
-#endif /* !XeTeX */
+#endif /* !XeTeX && !pTeX*/
 #endif /* !Aleph && !luaTeX */
 #if defined (eTeX) || defined(pdfTeX) || defined(Aleph) || defined(XeTeX) || defined(luaTeX)
       { "etex",                      0, &etexp, 1 },
@@ -1360,6 +1365,9 @@
       { "mktex",                     1, 0, 0 },
       { "no-mktex",                  1, 0, 0 },
 #endif /* TeX or MF */
+#ifdef pTeX
+      { "kanji",                     1, 0, 0 },
+#endif /* pTeX */
       { 0, 0, 0, 0 } };
 
 
@@ -1507,6 +1515,12 @@
       } else {
         WARNING1 ("Ignoring unknown argument `%s' to --interaction", optarg);
       }
+#ifdef pTeX
+    } else if (ARGUMENT_IS ("kanji")) {
+      if (!set_enc_string (optarg, NULL)) {
+        WARNING1 ("Ignoring unknown argument `%s' to --kanji", optarg);
+      }
+#endif /* pTeX */
       
     } else if (ARGUMENT_IS ("help")) {
         usagehelp (PROGRAM_HELP, BUG_ADDRESS);
@@ -2025,9 +2039,13 @@
   int i = EOF;
 
   /* Recognize either LF or CR as a line terminator.  */
+#ifdef pTeX
+  last = input_line2(f, buffer, first, bufsize, &i);
+#else /* pTeX */
   last = first;
   while (last < bufsize && (i = getc (f)) != EOF && i != '\n' && i != '\r')
     buffer[last++] = i;
+#endif /* pTeX */
 
   if (i == EOF && errno != EINTR && last == first)
     return false;
@@ -2062,6 +2080,11 @@
      buffer[i] = xord[buffer[i]];
 #endif
 
+#ifdef pTeX
+  for (i = last+1; (i < last + 5 && i < bufsize) ; i++)
+    buffer[i] = '\0';
+#endif /* pTeX */
+
     return true;
 }
 #endif /* !XeTeX */
Index: texk/web2c/ac/web2c.ac
===================================================================
--- texlive-20091011-source.orig/texk/web2c/ac/web2c.ac
+++ texlive-20091011-source/texk/web2c/ac/web2c.ac
@@ -28,9 +28,11 @@
               AS_HELP_STRING([--disable-omfonts],
                              [do not compile and install omfonts (use Web2C versions)],
                              kpse_indent_26))[]dnl
+dnl [PROG, BUILD-OR-NO, SYNC-OR-NO, TEXT, REQUIRED-LIBS]
 m4_define([kpse_tex_progs], [dnl
 [[tex],    [yes], [no],  [TeX],    []],
 [[etex],   [no],  [yes], [e-TeX],  []],
+[[ptex],   [yes], [no],  [pTeX],   [ptexenc]],
 [[aleph],  [yes], [no],  [Aleph],  []],
 [[pdftex], [yes], [yes], [pdfTeX], [xpdf libpng obsdcompat]],
 [[luatex], [yes], [no],  [luaTeX], [xpdf libpng obsdcompat]],
Index: texk/web2c/otps/Makefile.in
===================================================================
--- texlive-20091011-source.orig/texk/web2c/otps/Makefile.in
+++ texlive-20091011-source/texk/web2c/otps/Makefile.in
@@ -56,6 +56,7 @@
 	$(top_srcdir)/../../m4/kpse-libpng-flags.m4 \
 	$(top_srcdir)/../../m4/kpse-macos-framework.m4 \
 	$(top_srcdir)/../../m4/kpse-obsdcompat-flags.m4 \
+	$(top_srcdir)/../../m4/kpse-ptexenc-flags.m4 \
 	$(top_srcdir)/../../m4/kpse-socket-libs.m4 \
 	$(top_srcdir)/../../m4/kpse-teckit-flags.m4 \
 	$(top_srcdir)/../../m4/kpse-warnings.m4 \
@@ -231,6 +232,9 @@
 PACKAGE_VERSION = @PACKAGE_VERSION@
 PATH_SEPARATOR = @PATH_SEPARATOR@
 PKG_CONFIG = @PKG_CONFIG@
+PTEXENC_DEPEND = @PTEXENC_DEPEND@
+PTEXENC_INCLUDES = @PTEXENC_INCLUDES@
+PTEXENC_LIBS = @PTEXENC_LIBS@
 RANLIB = @RANLIB@
 SED = @SED@
 SET_MAKE = @SET_MAKE@
Index: texk/web2c/omegafonts/Makefile.in
===================================================================
--- texlive-20091011-source.orig/texk/web2c/omegafonts/Makefile.in
+++ texlive-20091011-source/texk/web2c/omegafonts/Makefile.in
@@ -54,6 +54,7 @@
 	$(top_srcdir)/../../m4/kpse-libpng-flags.m4 \
 	$(top_srcdir)/../../m4/kpse-macos-framework.m4 \
 	$(top_srcdir)/../../m4/kpse-obsdcompat-flags.m4 \
+	$(top_srcdir)/../../m4/kpse-ptexenc-flags.m4 \
 	$(top_srcdir)/../../m4/kpse-socket-libs.m4 \
 	$(top_srcdir)/../../m4/kpse-teckit-flags.m4 \
 	$(top_srcdir)/../../m4/kpse-warnings.m4 \
@@ -208,6 +209,9 @@
 PACKAGE_VERSION = @PACKAGE_VERSION@
 PATH_SEPARATOR = @PATH_SEPARATOR@
 PKG_CONFIG = @PKG_CONFIG@
+PTEXENC_DEPEND = @PTEXENC_DEPEND@
+PTEXENC_INCLUDES = @PTEXENC_INCLUDES@
+PTEXENC_LIBS = @PTEXENC_LIBS@
 RANLIB = @RANLIB@
 SED = @SED@
 SET_MAKE = @SET_MAKE@
Index: texk/web2c/web2c/convert
===================================================================
--- texlive-20091011-source.orig/texk/web2c/web2c/convert
+++ texlive-20091011-source/texk/web2c/web2c/convert
@@ -53,6 +53,12 @@
     midcmd="| sed -f $srcdir/web2c/cvtbib.sed"
     ;;
 
+  pbibtex)
+    midcmd="| sed -f $srcdir/web2c/cvtbib.sed"
+    more_defines="$srcdir/ptexdir/pbibtex.defines"
+    hfile=ptexdir/kanji.h
+    ;;
+
   mf)
     more_defines="$srcdir/web2c/texmf.defines $srcdir/web2c/mfmp.defines"
     precmd="| sed -f $srcdir/web2c/cvtmf1.sed"
@@ -66,7 +72,7 @@
 ${basefile}coerce.h"
     ;;
 
-  tex|etex|pdftex|aleph|xetex)
+  tex|etex|pdftex|aleph|xetex|ptex)
     more_defines="$srcdir/web2c/texmf.defines $srcdir/synctexdir/synctex.defines"
     prog_defines="$srcdir/${basefile}dir/$basefile.defines"
     if test -f $prog_defines; then
@@ -98,6 +104,11 @@
     output_files="$basefile[0-9].c ${basefile}ini.c ${basefile}d.h \
                  ${basefile}coerce.h"
     ;;
+
+  ptftopl|ppltotf|pdvitype)
+    more_defines="$srcdir/ptexdir/ptex.defines"
+    hfile=ptexdir/kanji.h
+    ;;
 esac
 
 # Do it.
@@ -125,11 +136,11 @@
 fi
 
 case $basefile in
-  bibtex)
-    sed -e 's/(buftype)//g' -e 's/(pdstype)//g' <bibtex.h >xbibtex.h
-    mv xbibtex.h bibtex.h
+  bibtex|pbibtex)
+    sed -e 's/(buftype)//g' -e 's/(pdstype)//g' <${basefile}.h >x${basefile}.h
+    mv x${basefile}.h ${basefile}.h
     ;;
-  tex|etex|luatex|pdftex|aleph|mf|xetex)
+  tex|etex|luatex|pdftex|aleph|mf|xetex|ptex)
     sleep 2 # so timestamps are definitely later, to avoid make weirdness
     cat $srcdir/web2c/coerce.h >>${basefile}coerce.h
     touch ${basefile}d.h
Index: texk/web2c/web2c/splitup.c
===================================================================
--- texlive-20091011-source.orig/texk/web2c/web2c/splitup.c
+++ texlive-20091011-source/texk/web2c/web2c/splitup.c
@@ -130,6 +130,9 @@
   } else if (STREQ (output_name, "xetex")) {
     fputs ("#define INITEX\n#define TeX\n#define XeTeX\n", out);
     coerce = "xetexcoerce.h";
+  } else if (STREQ (output_name, "ptex")) {
+    fputs ("#define INITEX\n#define TeX\n#define pTeX\n", out);
+    coerce = "ptexcoerce.h";
   } else if (STREQ (output_name, "mp")) {
     fputs ("#define INIMP\n#define MP\n", out);
     coerce = "mpcoerce.h";
Index: texk/web2c/Makefile.am
===================================================================
--- texlive-20091011-source.orig/texk/web2c/Makefile.am
+++ texlive-20091011-source/texk/web2c/Makefile.am
@@ -136,6 +136,9 @@
 ## e-TeX
 include $(srcdir)/etexdir/am/etex.am
 
+## pTeX
+include $(srcdir)/ptexdir/am/ptex.am
+
 ## pdfTeX
 include $(srcdir)/pdftexdir/am/pdftex.am
 include $(srcdir)/pdftexdir/am/libpdftex.am
Index: texk/web2c/aclocal.m4
===================================================================
--- texlive-20091011-source.orig/texk/web2c/aclocal.m4
+++ texlive-20091011-source/texk/web2c/aclocal.m4
@@ -1002,6 +1002,7 @@
 m4_include([../../m4/kpse-libpng-flags.m4])
 m4_include([../../m4/kpse-macos-framework.m4])
 m4_include([../../m4/kpse-obsdcompat-flags.m4])
+m4_include([../../m4/kpse-ptexenc-flags.m4])
 m4_include([../../m4/kpse-socket-libs.m4])
 m4_include([../../m4/kpse-teckit-flags.m4])
 m4_include([../../m4/kpse-warnings.m4])
